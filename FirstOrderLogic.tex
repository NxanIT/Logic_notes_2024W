\chapter{Predicate - / first order logic}
\defin{A First order Language}{
    consists of infinetely many distinct symbols such that no symbol is a proper 
    initial segment of another symbol and the symbols are divided into 2 groups:
    \begin{enumerate}
        \item logical symbols\outernote{logical symbols}\\
        (These elements have a fixed meaning and the equivalence symbol $=$ is optional)
        \begin{flalign*}
            (,),\lnot, \to, v_1,v_2,\dots,=&&
        \end{flalign*}
        \item parameters\outernote{parameters}
        \begin{itemize}
            \item quantifier symbol: $\forall$ (the range is subject of interpretation)
            \item predicate symbols: for every $n>0$ we have a set of $n$-ary predicates $P$
            \item constant symbols: Some set of constants (could also be $\varnothing$)
            \item function symbols: for every $n>0$ we have a set of $n$-ary function symbols
        \end{itemize}
    \end{enumerate}
}
\note{}{
    \begin{itemize}
        \item We could drop constants and instead introduce $0$-ary function symbols
        \item to specify language we need to specify the parameters and say if $=$ is included
        \item In the book \cite{EndertonHerbertB2001AMIt} they assume that
        some $n$-place predicate symbol is present for some $n$.
    \end{itemize}
}
\bsp{}{
    \begin{itemize}
        \item $\mathcal{L}_\text{set} = \{\in\}$, \quad $=$ included and the binary predicate symbol $\in$ "element in"
        \item $\mathcal{L}_\text{arith} = \{<,0,S,E,+,\cdot\}$
        \begin{itemize}
            \item [$=$] included
            \item [$<$] is a binary rel. symbol
            \item [$0$] is a constant
            \item [$S$] is a unary function symbol
            \item [$E$] exponentiation function symbol
            \item [$+,\cdot$] binary function symbols
        \end{itemize}
        \item $\mathcal{L}_\text{ring} = \{=,+,\cdot,-,0,1\}$
        \begin{itemize}
            \item [$=$] included
            \item [$0,1$] are constants
            \item [$-$] is a unary function symbol (additive inverse)
            \item [$+,\cdot$] binary function symbols
        \end{itemize}
    \end{itemize}
}

\section{Formulas}
\defin{Expression}{An \graybf{expression} is any finite sequence of symbols.
    There exist two kinds of expressions that makes sense "grammatically"
    \begin{itemize}[leftmargin=1.6cm]
        \item[Terms:] \begin{itemize}
            \item points to an object
            \item they are built up from variables and constants using function symbols %(by use of polish notation)
        \end{itemize}
        \item[Formulas:]\begin{itemize}
            \item They express assertions about objects,
            \item they are built up from atomic formulas 
            \item atomic formulas these are built up from terms using predicate symbols and $=$, if included
        \end{itemize}
    \end{itemize}
}
\defin{Term Building Operations}{
    For every $n>0$ and for every $n$-place function symbol $f$ let $\mathcal{F}_f$ be an $n$-place term building operation,
    that is $\mathcal{F}_f (t_1,\dots t_n)\defeq ft_1,\dots t_n$ (polish notation for $f(t_1,\dots t_n)$).
    The Set of terms\outernote{term}we then define as the set of expressions that are built up from variables and constants by applying the term building operations
    finitely many times.
}
\bsp{}{Let $\mathcal{L} = \mathcal{L}_{arith}$ then the set of terms will contain $0$, $v_{42}$, $S0$, $SSS0$, $Sv_1$, $+SOv_1$}
\defin{Atomic formula}{Any expression of the form 
    $$=t_1t_2 \text{ or } Pt_1,\dots t_n, \text{ where $t_1,\dots t_n$ are terms and $P$ is an $n$-ary predicate symbol}$$}
\note{}{Atomic formulas are not defined inductively.}
\bsp{}{\emph{cont.}\quad $=v_1 v_{42}$, $<S0 SS0$ are atomic formulas, but $\lnot = v_1 v_{42}$ is not.}
\defin{Formulas}{We define $\varepsilon_\lnot$, $\varepsilon_\to, Q_i$ to be the fla. building operations, defined as follows
    $\varepsilon_\lnot(\alpha) \defeq (\lnot \alpha)$, $\varepsilon_\to \defeq (\alpha \to \beta)$ and
    $Q_i(\gamma) \defeq \forall v_i \gamma$.
    The set of formulas\outernote{formula}is the set of expressions built up from atomic formulas by applying the fla. building operations finitely many times.
}
\bsp{}{\emph{cont.} $\forall v_1 (=Sv_10)$ is a formula we get by applying $Q_1$ on the atomic formula $=Sv_1 0$.}
\subsubsection*{Free variables}
\bsp{}{We introduce the $\exists$\outernote{$\exists$ quantifier} quantifier by defining $\exists y \alpha$ means $\lnot \forall y \lnot \alpha$.\\
    "Every non-zero natual number is a succsesor" $\forall x (x\neq 0\to \exists y S(y)=x)$
    is different then "if a number is not $0$, then it is a succsesor" $x\neq 0\to \exists y S(y)=x$. 
    $x$ occurs bounded\outernote{bounded variable} in the first formula, for the latter $x$ occures free in the fla.

    If you have an expression without free variables, it is either true or false, on the other hand
    if a variable occurs free in a formula, the truth value of it depends on the variable itself.
}
\defin{Free variables}{
    Let $x$ be a variable. $x$ occurs \graybf{free in $\varphi$} is defined inductively as follows:
    \begin{enumerate}
        \item If $\varphi$ is an atomic fla. then $x$ occurs \graybf{free} in $\varphi$ iff $x$ occurs in $\varphi$
        \item If $\varphi = (\lnot \alpha)$ then $x$ occurs free in $\varphi$ iff $x$ occurs free in $\alpha$
        \item If $\varphi = (\alpha \to \beta)$ then $x$ occurs free in $\varphi$ iff $x$ occurs free in $\alpha$ or $\beta$
        \item If $\varphi = \forall v_i \alpha$ then $x$ occurs free in $\varphi$ iff $x$ occurs free in $\alpha$ and $x\lnot v_i$
    \end{enumerate}
    A formula $\alpha$ is called a sentence,\outernote{sentence}if no variable occurs free in $\alpha$
}
\note{}{The above definition makes sense thanks to the recursion theorem.
    define the function $h$ on the set of atoms: $h(\alpha) = \text{the set of var occ in fla } \alpha$, which is the set of all variables $v_i$ that occur free in $\alpha$.
    we now want to extend $h$ to $\overline{h}$, which is the set of all formulas.
    \begin{itemize}
        \item $\overline{h}(\lnot \alpha) = \overline{h}(\alpha)$
        \item $\overline{h}( \alpha \to \beta) = \overline{h}(\alpha)\cup \overline{h}(\beta)$
        \item $\overline{h}(Q_i(\alpha)) = \overline{h}(\alpha)\backslash \{v_i\}$
    \end{itemize}
    We say $x$ occurs free in $\alpha$ iff $x\in \overline{h}(\alpha)$.
}
\note{}{We will now use $\lnot, \land,\lor,\to, \leftrightarrow, \exists v_i$ (all can be expressed in terms of $\lnot,\to,Q_i$.)
    We will sometimes drop the $(,)$ and not always be using polish notation.
}
\section{Semantics of first order logic}
The equivalent scheme to our TA in predicate logic. The meaning of formulas is given by \emph{structures}, 
which also determine the scope of the quantifier $\forall$, the meaning of all parameters.
\defin{structure}{A \graybf{structure} $\mathcal{A}$ for a first order language $\mathcal{L}$ is a non-empty set
    set $A$ called \graybf{universe} or \graybf{underlying set of $\mathcal{A}$} together with an interpretation of each parameters of $\mathcal{L}$ i.e.
    \begin{itemize}
        \item $\forall$ ranges over the universe $A$
        \item for an $n$-ary pred. symbol $P\in \mathcal{L}$ its interpretation $P^\mathcal{A}$ is a subset of $A^n$\outernote{interpretation}
        \item for a constant $c\in \mathcal{L}$ its interpretation $c^\mathcal{A}$ is an element of $A$
        \item for an $n$-ary function symbol $f\in \mathcal{L}$ its interpretation $f^\mathcal{A}$ is a total function $$f^\mathcal{A}: A^n \to A$$
    \end{itemize}
}
\note{}{$A\neq \varnothing$, and all functions $f^\mathcal{A}$ are total.}
\bsp{}{Let $\mathcal{L} = \{\in\}$ where $\in$ is a binary relation "
    An example of an $\mathcal{L}$ structure is $(\NN, \in^\NN)$ where $\in^\NN = \{(x,y)\in \NN^2 : x<y\}$}
\defin{Assigment}{Let $\varphi$ be a $\mathcal{L}$-fla. and $\mathcal{A}$ a $\mathcal{L}$-structure. 
    Let $V$ be the set of all variables in $\mathcal{L}$ and $s:V\to A$ an assignment.\outernote{assigment}
    We define the extention $\overline{s}$ of $s$ to the set of all $\mathcal{L}$-terms by
    \begin{itemize}
        \item if $x\in V$ then $\overline{s}(x) \defeq s(x)$
        \item for $c\in \mathcal{L}$ a constant symbol, then $\overline{s}(c) \defeq c^\mathcal{A}$
        \item for $t_1,\dots t_n$ $\mathcal{L}$-terms and $f\in \mathcal{L}$ an $n$-ary function symbol, then 
        $$\overline{s}(ft_1\dots t_n) \defeq f^\mathcal{A}(\overline{s}(t_1),\dots \overline{s}(t_n))$$
    \end{itemize}
}

\note{}{in the previous definition point 3. for $n=1$ yields a commutative diagram.

}
\prop{}{For any given assignment $s$ there exists a unique extention $\overline{s}$ as in the previous definition.}
{
    will follow from recursion theorem and unique decomposition of terms.
}
\newpage
\subsection*{Definition of truth}
\defin{Satisfy}{ We define '$\mathcal{A}$ satisfies $\varphi$ with $s$' and write
    $\mathcal{A}\models \varphi \:[s]$\outernote{$\models_\mathcal{A}$} or $\models_\mathcal{A} \varphi \:[s]$ inductively over the complexity of the formula $\varphi$
    \begin{enumerate}
        \item if $\varphi$ is atomic: \begin{itemize}
            \item $\mathcal{A} \models\: = t_1,t_2 \: [s]$ iff $ \overline{s}(t_1) = \overline{s}(t_2)$
            \item $\mathcal{A} \models P t_1,\dots t_n \: [s]$ iff $(\overline{s}(t_1),\dots \overline{s}(t_2))\in P^\mathcal{A}$
        \end{itemize}
        \item suppose $\mathcal{A}\models \varphi \: [s]$ and $\mathcal{A}\models \psi \: [s]$ are defined, then
        \begin{itemize}
            \item $\mathcal{A}\models \lnot\varphi \: [s]$ iff $\mathcal{A}\nvDash \varphi \: [s]$
            \item $\mathcal{A}\models \varphi\to \psi \: [s]$ iff $\mathcal{A}\models \psi \: [s]$ or $\mathcal{A}\nvDash  \varphi \: [s]$
            \item $\mathcal{A}\models \forall x \varphi \: [s]$ iff for all $a\in A$ $\mathcal{A}\models \varphi [s(x| a)]$
            where 
            \begin{equation*}
                s(x|a)(v) = \begin{cases}
                s(v) \text{ if } v \neq x\\
                a \text{ if } v = x
            \end{cases}
            \end{equation*}
            
        \end{itemize}
    \end{enumerate}
}
\bsp{}{
    $\mathcal{L} = \{\forall, \leq, S, 0\}$ 
    a $\mathcal{L}$-structure then could be $\mathcal{N} = (\NN,\leq^\mathcal{N},S^\mathcal{N},0^\mathcal{N})$ together with an assignment
    $s: v_n \mapsto n-1$ then:
    \begin{itemize}
        \item $s(v_1) = 0$
        \item $\overline{s}(0) = 0^\mathcal{N}$ (a constant is always mapped to its realisation, the interpretation of constant $0$ in the structure $\mathcal{N}$)
        \item $\overline{s}(Sv_1) = S^\mathcal{N}(\overline{s}(v_1)) = S^\mathcal{N}(0) = 1$\\
        \item $\mathcal{N}\models \forall v_1 (S(v_1) \neq v_1) \: [s]$\\
            iff for all $a\in \NN$ we have that $\mathcal{N}\models (S(v_1) \neq v_1) [s(v_1 | a)]$\\
            iff \dots \\
            iff for all $a\in \NN$ we have $S^\mathcal{A}(a) \neq a$, which is true in our structure of the natural numbers.
        \item Is it true in $\mathcal{N}$ that $\mathcal{N}\models S(0) \leq S(v_1) \: [s]$? Yes because
        \begin{equation*}
            \begin{split}
                &\mathcal{N}\models S(0) \leq S(v_1) \: [s] \\
                &\iif \: 1\leq 1
            \end{split}
        \end{equation*}
        
    \end{itemize}
}
\note{}{To know wheter $\mathcal{A}\models \varphi \: [s]$ it suffices to know where $s$ maps the variables that are free in $\varphi$}

\prop{}{\label{Thm.evalonlyfreevar}Suppose $s_1,s_2:V\to A$ agree on all variables that occur free in $\varphi$ then 
 $$\mathcal{A}\models \varphi \:[s_1] \text{ iff }\mathcal{A}\models \varphi \: [s_2]$$
}{
    By complexity of $\varphi$
    \begin{enumerate}
        \item if $\varphi$ is $P t_1,\dots t_n$ 
        note: any var that occur in $\varphi$ occur free in $\varphi$, so $s_1,s_2$ agree on all variables that occur in the terms $t_1,\dots t_n$.\\
        So we Claim: for $t$ a term, $s_1,s_2$ assignments that agree on all variables of $t$ then $\overline{s}_1(t) = \overline{s}_2(t)$
        \begin{claimproof}
            By complexity of $t$
            \begin{itemize}
                \item $t = v_m$ then  $\overline{s}_1(t) ={s}_1(v_m) = {s}_2(v_m) =\overline{s}_2(t)$
                \item $t = c$ then  $\overline{s}_1(t) =c^\mathcal{A} =\overline{s}_2(t)$
                \item $t = ft_1\dots t_n$ inductively, assume $\overline{s}_1(t_i) =\overline{s}_2(t_i)$ for all $1\leq i\leq n$ then  TODO
            \end{itemize}
        \end{claimproof}
        \item if $\varphi$ is $ =t_1,t_2$ is similar
        \item if $\varphi$ is $\lnot \alpha$ then $\mathcal{A}\models \lnot \alpha  \: [s_1]$ iff $\mathcal{A}\vDash \alpha  \: [s_1]$iff $\mathcal{A}\vDash \alpha  \: [s_2]$ iff $\mathcal{A}\models \lnot \alpha  \: [s_1]$
        \item if $\varphi$ is $\alpha \to \beta$ then $\mathcal{A}\models  \alpha \to \beta  \: [s_1]$ iff .. or .. iff for s2 iff ... or .. 
        \item if $\varphi$ is $ \forall x \alpha$ then the assumption is that $s_1,s_2$ .. the free variables of $\alpha$ are the free variables of $\varphi$ exept for $x$.
        but because $s_1(x|a) = s_2(x|a)$ they both agree on all free variables of $\alpha$.
        \[\begin{split}
            \mathcal{A}\models \forall x \varphi  \: [s_1] &\iif \fora a\in A \mathcal{A}\models \varphi  \: [s_1(x| a)]\\
            & \iif \fora a\in A \mathcal{A}\models \varphi  \: [s_2(x| a)]\\
            & \iif \mathcal{A}\models \forall x \varphi  \: [s_2]
        \end{split}\]
    \end{enumerate}
    
}
Notation: $\mathcal{A}\models \varphi $TODO means that all free variables of $\varphi$ are among $v_1,\dots v_n$ and $\mathcal{A}\models \varphi \: [s]$ whenever $s(v_i) = a_i$ for all $1\leq i\leq n$.
\coroll{If $\sigma$ is a sentence then $\mathcal{A}\models \sigma \: [s]$ for all $s:V\to A$ or 
$\mathcal{A}\vDash \sigma \: [s]$ for all $s:V\to A$.

Notation: $\mathcal{A}\models \sigma$ "$\sigma$ is true in $\mathcal{A}$, $\mathcal{A}$ is a model of $\sigma$ or $\sigma$ holds in $\mathcal{A}$.
}
\note{}{If $\sigma$ is a sentence then we can not have  $\mathcal{A}\models \sigma$ and  $\mathcal{A}\vDash \sigma$ because $A\neq \varnothing$.}
\defin{Model}{$\mathcal{A}$ is a model of a set of sentences $\Sigma$ iff for every sentence $\sigma\in \Sigma$ it holds  $\mathcal{A}\models \sigma$ }
\bsp{}{$\mathcal{L} = \{0,1,+,-,\cdot\}$
A realisation could be $\mathcal{R} = (\RR, 0,1,+,-,\cdot)$ or $\mathcal{C} = (\mathbb{C}, 0,1,+,-,\cdot)$
then the sentence 
$\sigma: \quad \exists x (x\cdot x = -1)$ then $\mathcal{R}\vDash \sigma$ but $\mathcal{C}\models \sigma$

}
\note{}{$\land,\lor,\leftrightarrow,\exists$ work as expected. That is 
 $\mathcal{A}\models (\alpha \land \beta) \: [s]$ iff $\mathcal{A}\models \alpha \: [s]$ and $\mathcal{A}\models \beta \: [s]$
 $\mathcal{A}\models (\alpha \lor \beta) \: [s]$ iff $\mathcal{A}\models \alpha \: [s]$ or $\mathcal{A}\models \beta \: [s]$
 $\mathcal{A}\models \exists x \alpha \: [s]$ iff $\mathcal{A}\models \lnot \forall x \lnot \alpha \: [s]$\\
 iff $\mathcal{A}\vDash \forall x \lnot \alpha \: [s]$\\
 iff it is not true that forall $a \in A$ $\mathcal{A}\models \lnot \alpha [s(x|a)]$\\
 iff there is $a\in A$ such that $\mathcal{A}\models \alpha [s(x|a)]$
}


\section{Logical implication}
Let $\Gamma$ be a set of $\mathcal{L}$-formulas, $\varphi$ a $\mathcal{L}$-formula.
\defin{Logical implication}{
    $\Gamma \models \varphi$ "$\Gamma$ logically implies $\varphi$" if for every $L$-structure $\mathcal{A}$ and for every $s:V\to A$ 

    if $\mathcal{A}\models \gamma \: [s]$for every $\gamma \in \Gamma$  then $\mathcal{A}\models \varphi \: [s]$

}

\defin{Logical equivalence}{$\varphi,\psi$ are called logically equivalent if 
$\varphi \models \psi$ and $\psi \models \varphi$.
}
\defin{Valid}{$\varphi$ is called valid iff $\models \varphi$ i.e. $\varnothing\models \varphi$ i.e. for every $\mathcal{L}$-structure $\mathcal{A}$ and every $s:V\to A$ it is $\mathcal{A}\models \varphi \: [s]$
}
\bsp{}{
\begin{enumerate}
    \item $\forall x_1 P x_1 \models P x_2$\\
    Suppose $\mathcal{A}\models \forall x_1 P x_1 \: [s]$.
    then for all $a\in A$ it is $\mathcal{A}\models P x_1 [s(x_1|a)]$ in particular, $a\in P^\mathcal{A}$ for $a = s(x_2)$
    \item  $\forall P x_2 \vDash \forall x_1 P x_1$\\
    We need a counterexample to $\forall P x_2 \models \forall x_1 P x_1$. Let $A = \{a_1,a_2\}$ $s(x_2) = a_1$ and $P^\mathcal{A} = \{a_1\}$
    then $\mathcal{A}\models Px_2 \: [s]$.
    \item Is the following valid? $\models \exists x(Px \to \forall y P y)$ yes
    \item $\Gamma,\alpha\models \varphi$ iff $\Gamma \models \alpha \to \varphi$. (on next problem set, quite impoirtant)
\end{enumerate}
}

\section{definability in a structure}
\defin{definability in a structure}{ 
    We say that a general $n$-ary relation $P$ on $A$ (we will just call it $P$, it does not have to be in the language) is definable in $\mathcal{A}$, if there is a $\mathcal{L}$-formula
    $\varphi$ with free variables among $\{v_1,\dots,v_n\}$ such that 
    \[P = \{(a_1,\dots a_n) : \mathcal{A} \models \varphi\: \llbracket a_1,\dots a_n\rrbracket\}\]
    We also say that $\varphi$ defines $P$ in the structure $\mathcal{A}$.
}
\bsp{}{
    \begin{enumerate}
        \item $x = x$ would define the entire universe.
        \item $\lnot x = x$ would define the empty set.
    \end{enumerate}
}
\bsp{}{
\begin{enumerate}
    \item TODO
    \item $\mathcal{R} = (\RR,0,1,+,-,\cdot)$ Q: is $[0,\infty)$ definable in $\mathcal{R}$
    Yes because $\exists y (y\cdot y = x)$
    Indeed we can even define the $\leq$ relation on $\RR^2$ by $x\leq z \defaq \exists y (x+y\cdot y = z)$ 
\end{enumerate}
}
\defin{definability of classes of structures}{
    Let $\Sigma$ be a set of sentences. $\tau$ a sentence.
    We will say that the class of models of $\Sigma$ is the class $\Mod \Sigma =\{\mathcal{A} : \mathcal{A}\models \Sigma\}$.
    Let $K$ be a class of structures. We are going to call $K$ an elementary class (EC) if there is a single sentence $\tau$ such that $K = \Mod \tau$.
    $K$ is called an elementary class in the wider sence (EC$_\Delta$) if there is a set of sentences $\Sigma$ such that $K = \Mod \Sigma$

}
\bsp{}{$\mathcal{L} = \{0,1,+,\cdot\}$ 
    $\tau$ is a sentence that expresses the field axioms (the unary inverse functions are not in our language but are definable.)
    $\Mod \tau$ is the class of all the fields, which is EC.
    the class of all fields of characteristic $0$. Let $\sigma_p: \lnot(1 + \dots +1 = 0)$ then $\Sigma = \{\tau\} \cup \{\sigma_p : p\in \mathbb{P}\}$ 
    yields $\Mod \Sigma$ is the class of fields with characteristic $0$, therefore EC$_\Delta$, we will later see that it is not $EC$.

}
\bsp{}{
    Let $E$ be a binary relation, $\mathcal{L} = \{E\}$ then a graph is a realisation $\mathcal{G} = (V,E^\mathcal{G})$ 
    such that $v\neq \varnothing$, $E^\mathcal{G}$ is irreflexive and symmetric.
    By definition the universe is not empty, we still have to check irreflexive and symmetric.
    \begin{itemize}
        \item irreflexive: $\forall x (\lnot x E x)$
        \item symmetric: $\forall x \forall y (x E y \to y E x)$
    \end{itemize}
    We take $\tau$ to be $\forall x \forall y ((\lnot x E x)\land (x E y \to y E x))$
    Then $\Mod \tau$ is the class of all graphs and is EC
    Note: the class of all finite graphs is neither EC nor EC$_\Delta$. proof later.
}
We want to have some notion that tells us when two graphs are the same or at least similar.
\section{Homomorphisms of structures}
\defin{Homomorphism}{
    Suppose that $\mathcal{A},\mathcal{B}$ are two $\mathcal{L}$-structures. then a Homomorphism of $\mathcal{A}$ into $\mathcal{B}$ is a map
    $h: A \to B$ that satisfy the below conditions
    \begin{itemize}
        \item for every $n$-ary predicate $P\in \mathcal{L}$ it is $(a_1,\dots a_n)\in P^\mathcal{A}$ iff $(h(a_1),\dots h(a_n))\in P^\mathcal{B}$ (this def. a strong Homomorphism, other textbooks maybe only reqire $\to$ direction)
        \item for every $n$-ary function $f\in \mathcal{L}$ and for all $\underline{a} = (a_1,\dots a_n)\in A^n$ it holds $h(f^\mathcal{A}(\underline{a})) = f^\mathcal{B}(h(a_1),\dots h(a_n))$
        \item for every constant symbol $c\in \mathcal{L}$ it is $h(c^\mathcal{A}) = c^\mathcal{B}$ (could also skip this if we consider constants as $0$-ary functions)
    \end{itemize}
}
\note{}{Intuativly a Homomorphism of $\mathcal{A}$ into $\mathcal{B}$ is a map $A \to B$ that preserve all funciton and relation symbols in some sense, (imp: not the definable relations)}
\defin{Isomorphism}{
    \begin{itemize}
        \item $h:A\to B$  is called isomorphism of $\mathcal{A}$ into $\mathcal{B}$ if $h$ is a Homomorphism and injective (in other textbooks: an isomorphic embedding of $\mathcal{A}$ into $\mathcal{B}$)
        \item $h:A\to B$  is called isomorphism of $\mathcal{A}$ onto $\mathcal{B}$ if $h$ is a Homomorphism and bijective $A\to B$
        \item \outernote{isomorphic}$\mathcal{A}$ and $\mathcal{B}$ are called isomorphic if there is an isomorphism of $\mathcal{A}$ onto $\mathcal{B}$
    \end{itemize}
}
\note{}{
    %TODO: in general 
}
\bsp{}{
    $\mathcal{L}= \{+,\cdot\}$
    $\mathcal{N} = (\NN, +^\NN, \cdot^\NN)$ and $\mathcal{B} = (B,+^\mathcal{B},\cdot^\mathcal{B})$ where $B = \{0,1\}$ and 
    \begin{tabular}{c|c c}
        $+^\mathcal{B}$ & $e$ & 0\\\hline
        $e$ & $e$ & 0\\
        0 & 0 & $e$
    \end{tabular}
    \begin{tabular}{c|c c}
        $\cdot^\mathcal{B}$ & $e$ & 0\\\hline
        $e$ & $e$ & $e$\\
        0 & $e$ & 0
    \end{tabular}
    let $h:\NN \to B$ a Homomorphism?
    $h(n) = \begin{cases}
        e & \text{ if $n$ is even}\\
        0 & \text{ else}
    \end{cases}$
    need at first that $h(m+n ) = h(m) +^\mathcal{B} h(n)$
    and $h(m\cdot n) = h(m)\cdot^\mathcal{B} h(n)$.
    it is indeed a Homomorphism.
}
\defin{Substructure}{Suppose we have two $\mathcal{L}$ structures and $A\subseteq B$ hen $\mathcal{A}$ is a substructure of $\mathcal{B}$ 
    (notation: $\mathcal{A}\subseteq \mathcal{B}$ or we might say $\mathcal{B}$ is an extention of $\mathcal{A}$ ) if
    \begin{itemize}
        \item for every $n$-ary relation $P^\mathcal{A} = P^\mathcal{B}|_A$
        \item for every $n$-ary function $f^\mathcal{A} = f^\mathcal{B}|_A$
        \item for every constant symbol $c$ in $\mathcal{L}$ it is $c^\mathcal{A} = c^\mathcal{B}$
    \end{itemize}
}
\bsp{}{
    $\mathcal{L} = \{\leq\}$ then $\mathcal{N} = (\NN, \leq)$ and $\mathcal{P} = (\NN^+, \leq ^\mathcal{P})$ where $\leq^\mathcal{P}$ is the restriction of $\leq$ to the positive natual numbers.
    $\mathcal{P} \subseteq \mathcal{N}$ and there exists a isomorphic embedding $id: \NN^+\to \NN$ from $\mathcal{P}$ into $\mathcal{N}$
    They are even isomorphic ($h:\NN \to \NN^+, h(n) = n+1$) so in fact $\mathcal{P} \cong \mathcal{N}$.
}
\bsp{}{
    $(\mathbb{Q},+)\subseteq(\mathbb{C},+)$
}
\note{}{If $\mathcal{A}\subseteq \mathcal{B}$ then in particular $\mathcal{A}$ is closed under all constant and functions in $\mathcal{B}$
    So suppose that $\mathcal{B}$ is a substructure and $A\subseteq B$ and $A\neq \varnothing$ and $A$ is closed under $f^\mathcal{B}$, $c^\mathcal{B}$ 
    Can then $A$ be made into a substructure $\mathcal{A}$ of $\mathcal{B}$.
    $f^\mathcal{A}$ would be the restriction of $f^\mathcal{B}$ to $A^n$, constants $c^\mathcal{A} = c^\mathcal{B}$ 
    and if $P \in \mathcal{L}$ is an $n$-ary predicate then $P^\mathcal{A}$ should be $P^\mathcal{B}\cap A^n$.
    If $\mathcal{L}$ has no const. or fuction symbols then any subset can be made into a substructure of a structure on $\mathcal{L}$.
}
Our next question will be: what is the relation of the above notions with truth and satisfiability
The answer will be given by the so called Homomorphism theorem.

\prop{Homomorphism theorem}{
    $h$ homomorphism of $\mathcal{A}$ into $\mathcal{B}$, $s:V\to A$ then
    \begin{enumerate}
        \item for all terms $t$ it is $h(\overline{s}(t))=\overline{(h\circ s)}(t)$
        \item $\varphi$ a fla. that is quantifier free and does not include $=$ then $\mathcal{A}\models \varphi \: [s]$ iff $\mathcal{B}\models \varphi  \: [h\circ s]$
        \item if $h$ is additionally injective then we can drop the requirement " no $=$".
        \item if $h$ is homomorphism of $\mathcal{A}$ onto $\mathcal{B}$ then we can drop the requirement "q.f." in (b)
    \end{enumerate}
}{
    \begin{enumerate}
        \item problem set
        \item \begin{itemize}
            \item $\varphi: Pt$ then $\mathcal{A}\models Pt \: [s]$ iff $\overline{s}(t)\in P^\mathcal{A}$ iff $h(\overline{s}(t))\in P^\mathcal{B}$ iff $\overline{(h\circ s)}(t)\in P^\mathcal{B}$ 
            iff $\mathcal{B}\models Pt  \: [h\circ s]$
            \item $\varphi: \lnot \psi$ $\mathcal{A}\models \lnot \psi \: [s]$ iff $\mathcal{A}\vDash \psi \: [s]$ iff $\mathcal{A}\vDash \psi \: [s]$ iff %TODO
            \item $\varphi: \psi \to \alpha$
        \end{itemize}
        \item $\mathcal{A}\models =t_1t_2 \: [s]$ iff $\overline{s}(t_1)=\overline{s}(t_2)$ iff $h(\overline{s}(t_1))=h(\overline{s}(t_2))$ iff (by (a))$\overline{(h\circ s)}(t_1) = \overline{(h\circ s)}(t_2)$ 
        iff $\mathcal{B}\models =t_1t_2 \: [h\circ s]$
        \item $\varphi$ $ \forall s: V\to A$ $\mathcal{A}\models \varphi \: [s]$ iff $\mathcal{B}\models \varphi  \: [h\circ s]$, want $\mathcal{A}\models \forall x \varphi \: [s]$ iff 
        $\mathcal{B}\models \forall x \varphi  \: [h \circ s]$
        1. $\mathcal{B}\models \forall x \varphi  \: [(h\circ s)]$
        iff for all $s:V\to A$, $a\in A$ (req. surjectivity) it is $\mathcal{B}\models \varphi  \: [(h\circ s)(x | h(a))]$
        iff $\mathcal{B}\models \varphi  \: [h\circ (s(x |a))]$
        iff (inductive assumption)$\mathcal{A}\models \varphi  \: [s(x|a)]$ because $a$ was arbitrary it is $\mathcal{A}\models \forall x \varphi \: [s]$
        2. Suppose $\mathcal{B}\vDash \forall x \varphi  \: [(h\circ s)]$ then there exists a $b\in B$ such that $\mathcal{B}\models \lnot \varphi  \: [(h\circ s)(x | b)]$
        by surjectivity we can find $a\in A$ such that $h(a)=b$ and it is $\mathcal{B}\models \lnot \varphi  \: [(h\circ s)(x | h(a))]$
        By the inductive assumption $\mathcal{A}\models \lnot \varphi  \: [s(x|a)]$ and $\mathcal{A}\vDash \forall x \varphi \: [s]$
    \end{enumerate}
}
\note{}{$\mathcal{A}\cong \mathcal{B}$ then $\mathcal{A}$ and $\mathcal{B}$ satisfy exactly the same sentences.}
\defin{elementarily equivalent}{$\mathcal{A}$ and $\mathcal{B}$ are called elementarily equivalent ($\mathcal{A}\equiv \mathcal{B}$) if $\mathcal{A}$ and $\mathcal{B}$ satisfy the same sentences.}
\note{}{If $\mathcal{A}\cong \mathcal{B}$ implies $\mathcal{A}\equiv \mathcal{B}$
    The converse is not true.
    For instance DLO (dence linear order) w/o endpoints is complete, so two structures on DLO are equivalent 
    $(\mathbb{Q},<)\equiv (\RR,<)$ but they are not isomorphic because the universes have diffrent cardinality. 
}
\bsp{}{
    $\mathcal{N} = (\NN, \leq)$ and $\mathcal{P}=(\NN^{>0},\leq )$ $h:n\mapsto n-1:\mathcal{P}\to \mathcal{N}$ isom. 
    so in part $\mathcal{N} \equiv \mathcal{P}$.
    but $id:\mathcal{P}\to \mathcal{N}$ is only isom embedding, so for example
    $\forall y(x\neq y x\leq y)$  
    $\mathcal{P}\models \alpha  \: [1]$ but $\mathcal{N}\nvDash \alpha  \: [1]$
    but $\mathcal{N}\models \alpha  \: [h(1)]$
}
\defin{Automorphism}{An automorphism is an isomorphism of the form $h:A\to A$ from $\mathcal{A}$ onto $\mathcal{A}$}
\note{}{Every structure has a trivial automorphism $id:A\to A$}
\defin{Rigid}{If the only automorphism on $\mathcal{A}$ is the trivial automorphism, then $\mathcal{A}$ is called rigid.}
\bsp{}{ If every element is definable then the structure is rigid.
    For example $(\NN,0,S)$ and $(\NN,<)$ every element is definable, therefore the structures are rigid.
    %TODO examples structures with many automorphism
    }
\coroll{
    Let $h$ be atutom of $\mathcal{A}$, $R\subseteq A^n$ definable in $\mathcal{A}$ then $\forall a\in A^n a\in R \iif (h(a_1),\dots h(a_n))\in R$ 
    Suppose $\varphi$ defines $R$ in $\mathcal{A}$ we want
    $\mathcal{A}\models \varphi \: [a]$ iff  $\mathcal{A}\models \varphi \: [h(a_1),\dots h(a_n)]$ which is true by the homom. thm.
}
\note{}{Corol can be used to show that some $R\subseteq A^n$ is not definable in $\mathcal{A}$
}
\bsp{}{
    $\mathcal{R}=(\RR,<)$ then $\NN$ is not definable in $\mathcal{R}$.
    What do automorphisms of $\mathcal{R}$ look right? 
    $h:\RR\to \RR$ is a bijection and $x<y$ iff $h(x)<h(y)$ so $h$ is strictly increasing.
    for example $x\mapsto x+ \frac{1}{2}$ or $x\mapsto x^3$.  
}
\section{Unique readability for terms}
\defin{}{
    We define $K$ on symbols from which terms are built up (variables, constants, function symbols).
    $K(s) = 1-n$ where $s$ is a symbol and $n$ is the number of terms that need to follow s in order to obtain a term.
    $K(x) = 1 = K(c)$ and $K(f) = 1-n$ where f is an $n$-ary funciton symbol
    We now extend $K$ to the set of all expressions which are built up from above symbols (variables, constants, function symbols):
    $K(s_1,\dots s_n) = K(s_1) + \dots + K(s_n)$ (unique because no symbol is a finite sequence of other symbols)
}
\lemma{}{
    $t$ a term then $K(t)=1$
}{
    $K(x) = 1 = K(c)$ and $K(ft_1,\dots t_n) = 1-n + n = 1$ 
}
\defin{}{A terminal segment of string of symbols $(s_1,\dots s_n)$ is $(s_k,s_{k+1},\dots s_n)$ for some $1\leq k\leq n$.}
\lemma{}{Any terminal segment of terms is a concatenation of one or more terms.}{
    True for variables and constants. 
    $ft_1\dots t_n$ the only non trivial case is $t'_k t_{k+1}\dots t_m$ where $t_k$ is $t''_k t_k'$
}
\coroll{If $t_1$ is a proper initial segment of a term $t$ then 
 its $K(t_1)<1$. proof:
    let $t$ be $t_1 t_2$ where $t_1$ is a proper initial segment then $K(t) = 1$ and $K(t_2)\geq1$ therefore $K(t_1)\leq 0$
}
\subsubsection{Unique readability for terms}
The set of terms is freely generated from the set of variables(Var), the set of constant symbols (Const) by the term building operations $\mathcal{F}_f$ for the function symbols $f$.
\begin{proof}
    
     \begin{itemize}
        \item disjointment of ranges: Let $f$ and $g$ be two distinct funciton symbols then $\rng\mathcal{F}_f \cap \rng\mathcal{F}_g =\varnothing$
        $\rng\mathcal{F}_f \cap Var =\varnothing$
        $\rng\mathcal{F}_f \cap Const =\varnothing$
        \item $\mathcal{F}_f|_{\text{terms}}$ are 1-1:
        assume $ft_1\dots t_n = f t'_1\dots t'_n$ and assume $t_1 \neq t_1'$ then one is an initial segment of the other.
        Then its $K$-value has to be less than $1$ so it is not a term.
        $t_1 = t_1' \dots t_n=t_n'$.
     \end{itemize}
\end{proof}
\defin{}{Extend $K$ as follows: $K(() = -1$ $K()) = 1$ $K(\forall) = 1$ $K(\lnot) = 0$ $K(\to) = -1$ $K(P) = 1-n$ for an $n$-ary rel. symb. $P$. $K(=) = -1$.
    Extend $K$ to the set of all expressions by $K(s_1,\dots s_n) = K(s_1) + K(s_n)$
    The idea is that $K$ tells us the number of symbols that at least need to follow to obtain a formula.
}
\lemma{}{
    for every formula $\varphi$ it is $K(\varphi) = 1$
}{
    induction on $\varphi$
}
\lemma{}{for every proper initial segment $\alpha'$ of a fla. $\alpha$ we have $K(\alpha')<1$}{}
\coroll{No proper initial segment of a fla. is a fla.}
The set of flas. is freely generated from the set of atomic flas. by operations $\mathcal{E}_\lnot,\mathcal{E}_\to,Q_i$
\begin{proof}
    \begin{itemize}
        \item $\mathcal{E}_\lnot,Q_i$ are one to one
        \item $\mathcal{E}_\to|_{\text{Flas.}}$ then itemwise and use of prev. lemmas
        \item p.w. disjointness of ranges
    \end{itemize}
\end{proof}

\section{A parsing algorithm for first order logic}

\section{Deductions (formal proofs)}
\defin{Modus Ponens}{We will use one rule of interference, Modus Ponens(MP).\addAbbrev{MP}{Modus Ponens}\outernote{MP} Our notation will be: 
$$\frac{\alpha, \alpha\to \beta}{\beta}$$
And it reads as follwos: "If $\alpha$ and $\alpha \to \beta$ then $\beta$."
This rule is the formalisation of the rather informal statement: "If we know a statement $\alpha$ is true, 
and this statement implies another statement $\beta$, then $\beta$ must also be true."

}
\defin{Deduction}{A formal proof (decuction) of a fla $\varphi$ from a set of formulas $\Sigma$ is a finite sequence of formulas 
    $(\alpha_0,\alpha_1,\dots,\alpha_n)$ such that $\alpha_n = \varphi$ and for every $i<n$ $\alpha_i$ is either a logical axiom or $\alpha_i\in\Sigma$ or 
    $\alpha_i$ is obtained from $\alpha_k$ and $\alpha_l$ where $0\leq k,l<i$ by the use of MP, in particular $\alpha_k = \beta \to \alpha_i$ and $\alpha_l = \beta$.
    If a deduction of $\varphi$ from $\Sigma$ exists, we say "$\varphi$ is deducible from $\Sigma$" or "$\varphi$ is a theorem of $\Sigma$".
}
\note{}{Deductions are not unique. However we do have an induction principle:
    If a set of formulas contains all logical axioms and all of $\Sigma$ and is closed under MP, then it contains all theorems of $\Sigma$.
}
\subsubsection{Logical axioms}
\defin{Generalization}{$\psi$ is a generalization of $\varphi$ if $\psi = \forall x_{i_1}\dots \forall x_{i_k} \varphi$ 

}
\defin{Logical axioms}{Let $x,y$ be variables and $\alpha, \beta$ formulas. then the logical axioms are generalizations of the following formulas:
    \begin{enumerate}
        \item tautologies
        \item $\forall x \alpha \to \alpha_t^x$ where $t$ is substitutable for $x$ in $\alpha$ 
        \item $\forall x (\alpha \to \beta) \to (\forall x \alpha \to \forall x \beta)$
        \item $\alpha\to \forall x \alpha$ where $x$ does not occur free in $\alpha$
    \end{enumerate}
    if our language contains $=$ then 
    \begin{enumerate}
        \item $x=x$ 
        \item $x=y \to (\alpha \to \alpha')$ where $\alpha'$ is obtained from $\alpha$ by replacing some of the occurences of $x$ with $y$.
    \end{enumerate}
    
}
\subsubsection*{Ad axiom group (2), Substitution: }
\defin{Substitution}{Let $\alpha,\beta$ be formulas, $x$ a variable and $t$ a term then $\alpha_t^x$ is expression obtained from $\alpha$ by substituting $t$ for $x$ 
    We define substitution inductive as follows:
    \begin{enumerate}
        \item if $\alpha$ is atomic then $\alpha = \text{expression obtained from $\alpha$ by replacing all $x$'s by $t$'s
        }$
        \item $(\lnot \alpha)^x_t = \lnot (\alpha^x_t)$
        \item $( \alpha\to \beta)^x_t = (\alpha^x_t)\to  (\beta^x_t)$
        \item $(\forall y \alpha)^x_t = \begin{cases}
            \forall y  (\alpha^x_t) &\text{ iff } x\neq y\\
            \forall x \alpha &\text{ iff } x=y
        \end{cases}$
    \end{enumerate}
}
\bsp{}{
    \begin{itemize}
        \item $ \alpha^x_x = \alpha$
        \item Let $\alpha = \lnot \forall y x = y$ what is $\forall x \alpha \to   \alpha^x_z$?
        \[\forall x \lnot \forall y x=y \leadsto \lnot \forall y z=y\]
        What is $\forall x \alpha \to \alpha_y^x$
        $\forall x \lnot \forall y x=y$ is true in all structures with a universe $A$ with $|A|\geq 2$.
        \[\forall x \lnot \forall y x=y\leadsto  \lnot \forall y y = y\]
        and $\lnot \forall y y = y$ is an antitautology (it is always false).
        \item 
    \end{itemize}
}
So we have to define substitutable
\defin{substitutable}{\addAbbrev{SUB}{substitutable}
    Let $x$ be a variable, $t$ a term. Then $t$ is substitutable for $x$ in $\alpha$ if
    \begin{enumerate}
        \item $\alpha$ atomic then $t$ is SUB for $x$ in $\alpha$
        \item then $t$ is SUB for $x$ in $\lnot \alpha$ iff then $t$ is SUB for $x$ in $\alpha$
        \item then $t$ is SUB for $x$ in $\alpha\to \beta$ iff then $t$ is SUB for $x$ in $\alpha$ and $\beta$
        \item then $t$ is SUB for $x$ in $\forall y \alpha$ iff either
        \begin{itemize}
            \item $x$ does not occur free in $\forall y \alpha$ or
            \item $y$ does not occur in $t$ and $t$ is SUB for $x$ in $\alpha$
        \end{itemize}
    \end{enumerate}
}
\bsp{}{For instance the following is a logical axiom.
    \[\forall x_3 (\forall x_1 (Ax_1 \to \forall x_2 Ax_2)\to (Ax_2\to \forall x_2 A x_2))\]
    It is a generalization of $\forall x_1 (Ax_1 \to \forall x_2 Ax_2)\to (Ax_2\to \forall x_2 A x_2)$
    which is by point two a substitution with $\alpha = Ax_1 \to \forall x_2 Ax_2$. Then $\alpha_{x_2}^{x_1} = Ax_2\to \forall x_2 A x_2$
    And $x_2$ is indeed substitutable for $x_1$ in $\alpha$ because it does not get bounded.
    
    \[\forall x_1 (\forall x_2 B x_1 x_2 \to \forall x_2 B x_2 x_2)\]
    is a generalization of point (2), but $x_2$ is not substitutable for $x_1$ in $\alpha = $, therefore it is not a logical axiom.
}
\subsubsection{Ad (1): tautologies}
\defin{Tautologies of first order language}{Tautologies are the formulas obtained from tautologies of propositional logic by replacing all propositional atoms by formulas of first order logic.
    
    An alternative definition is:
    Divide all formulas of first order logic into two groups:
    \begin{enumerate}
        \item atomic formulas and generalizations of first order formulas (these are called prime formulas)
        \item all other formulas i.e. of the form $\lnot \alpha$ and $\alpha \to \beta$ (non-prime formulas)
    \end{enumerate}
    So any first order formula is built up from the prime formulas using finitly many times the formula building operations. $\mathcal{E}_\lnot$ $\mathcal{E}_\to$ 
    We have unique readability because the set of formulas is freely generated.
}
\bsp{}{\[\lnot (\forall y (Px \to Py))\to (Px\to \forall y \lnot Py)\]
is built up from $\lnot (\forall y (Px \to Py))$ and $Px\to \forall y \lnot Py$.
which itself $\forall y (Px \to Py)$ and 
$Px$ and $\forall y \lnot Py$ where they are all prime formulas.
}
\bsp{}{Is the following a tautology?
\[(\forall y (\lnot Py)\to \lnot Px)\to (Px\to \lnot\forall y \lnot Py)\]
We construct the construction tree into prime formulas and then assign truth values to them and evalue the truth value of the whole formula.
It is indeed a tautology.
}
\note{}{
    \begin{itemize}
        \item $\forall x(Px \to Px)$ is a prime formula which corresponds to a propositional atom, and therefore not a tautology.
But it is a generalization of a tautology and therefore by (1) a logical axiom.
        \item $\forall x Px \to Px$ is not a tautology but is a logical axiom by group (2).
    \end{itemize}
}
\note{}{
    $\Gamma \models_{\text{taut}} \varphi$ from propositional logic can be translated to first order logic.
}
\lemma{}{If $\Gamma\models_{\text{taut}}\varphi$ then $\Gamma \models\varphi$}{
    Problem set.
}
\note{}{The converse fails. For instance $\forall x Px \models Pc$. However $Pc$ is a diffrent propositional atom 
then $\forall x Px $ they have no connection between them when viewed in propositional logic. 

We will prove $\Gamma\models \varphi$ iff $\Gamma\vdash \varphi$ (the first direction is completeness and the converse soundness.)}
\prop{}{$\Gamma\vdash \varphi$ iff $\Gamma \cup \Lambda \models_{\text{taut}}\varphi$}{
    \begin{itemize}
        \item Let $\Gamma \vdash \varphi$ and $v$ be a truth assigment that satiesfies every element in $\Gamma \cup \Lambda$. Induction on deduction of $\varphi$ from $\Gamma$.
            \begin{itemize}
                \item if $\varphi \in \Gamma\cup \Lambda$ then we are done
                \item if $\varphi$ is obtained from $\alpha$, $\alpha\to \varphi$ by MP then $v$ satiesfies $\alpha$ and $\alpha \to \varphi$
                
                $\{\alpha, \alpha\to \varphi \} \models_{\text{taut}} \varphi$
            \end{itemize}
        \item Assume $\Gamma \cup \Lambda \models_{\text{taut}}\varphi$. Then by the compactness theorem for propositional logic there are $\gamma_1\dots, \gamma_n\in\Gamma$ and $\lambda_1,\dots \lambda_m\in\Lambda$ such that
            \[\gamma_1\to \gamma_2\to \dots \to \gamma_n \to \lambda_1\to \dots \to \lambda_m\]
            is a tautology (always grouped to the left) because $\Gamma \cup \{\alpha\}\models_{\text{taut}}\beta$ iff $\Gamma \models_{\text{taut}}(\alpha \to \beta)$
    \end{itemize}
}
\section{Generalization and deduction theorem}
\note{}{Intuativly if $\Gamma$ does not assume anything about $x$ and $\Gamma$ proves $\varphi$ then $\Gamma$ proves $\forall x \varphi$}
\prop{Generalization theorem}{If $\Gamma \vdash \varphi$ and $x$ does not occur free in $\Gamma$, then $\Gamma \vdash \forall x \varphi$}{
    We use axiom group 4, $\alpha \to \forall x \alpha$ if $x$ is not occuring free in $\alpha$.
    Since $x$ does not occur free in $\sigma\in\Gamma$, if $\varphi \in \Thm \Gamma$ then $\forall x \varphi \in \Thm \Gamma$.
    Induction principle:
    $S$ the set of flas. If $\Lambda\cup \Gamma\subseteq S$ and $S$ is closed under MP then $S$ contains $\Thm (\Gamma)$.
    It is enough to show that $\{\varphi: \Gamma \vdash \forall x \varphi\}$ contains $\Gamma \cup \Lambda$.
    and is closed under MP.
    \begin{enumerate}
        \item if $\varphi$ is a logical axiom then $\forall x \varphi$ is a generalization and therefore also a logical axiom, so $\Gamma \vdash \forall x \varphi$
        \item Lets assume $\varphi in \Gamma$. then $x$ does not occur free in any element of $\Gamma$, then $\varphi \to \forall x \varphi$ is a logical axiom and $\Gamma \vdash \forall x \varphi$ by MP.
        \item Closedness under MP. suppose $\varphi$ is obtained from $\psi$, $\psi \to \varphi$ by MP. Then by induction hyphothesis $\Gamma \vdash \forall x \psi$ and $\Gamma \vdash \forall x (\psi  \to \varphi)$
        Then $\forall x (\psi \to \varphi) \to (\forall x \psi \to \forall x \varphi)$ is a logical axiom in group 3.
        Then by MP $\Gamma \vdash \forall x \psi \to \forall x \varphi$\\
        By MP again $\Gamma \vdash \forall x \varphi$
    \end{enumerate}
}
\note{}{Suppose $x$ has free occurence in $\Gamma$ 
    for example $Px \nvDash \forall x Px$ so we can not have $Px \vdash \forall x Px$ (want $\models$ iff $\vdash$)
}
\note{}{
    Proof of Generalization theorem can be used to obtain a deduction of $\forall x \varphi$ from $\Gamma$ from a deduction of $\varphi$ from $\Gamma$.
}
\lemma{Rule T}{If $\Gamma\vdash \alpha_1$, $\Gamma\vdash \alpha_2$,\dots $\Gamma\vdash \alpha_n$ and $\{alpha_1,\alpha_2,\dots \alpha_n\}\models_{\text{taut}}\beta$ then $\Gamma \vdash \beta$. }{
    $\alpha_1\to \alpha_2 \to \dots \to \alpha_n \to \beta$ is a logical axiom because it is a tautology.
    Apply MP $n$-times.
}
\prop{Deduction theorem}{If $\Gamma \cup \{\gamma\}\vdash \varphi$ then $\Gamma \vdash (\gamma \to \varphi)$}{
    Assume $\Gamma \cup \{\gamma\}\vdash \varphi$.
    $\Gamma \cup \{\gamma\}\vdash \varphi$ iff $\Gamma \cup \{\gamma\}\cup \Lambda \models_{\text{taut}} \varphi$ \\
    iff $\Gamma \cup \Lambda \models_{\text{taut}} \gamma \to \varphi$ (exercise sheet 1, ex 7)\\
    iff $\Gamma \vdash (\gamma \to \varphi)$
}
\note{}{Deduction theorem is an equivalence. $\Gamma \vdash \gamma \to \varphi$ then $\Gamma \cup \{\gamma\}\vdash \gamma$. the statement follows by MP.}


\coroll{(Contraposition): If $\Gamma\cup \{\varphi\}\vdash \lnot \psi$ then $\Gamma\cup \{\psi\}\vdash \lnot \varphi$ }
\begin{proof}
    Suppose $\Gamma\cup \{\varphi\}\vdash \lnot \psi$ then by deduction theorem $\Gamma \vdash \varphi\to \lnot \psi$
    We observe that $\{\varphi \to \lnot \psi\}\models_{\text{taut}} \psi \to \lnot \varphi$.

    By rule T: $\Gamma \vdash \psi \to \lnot \varphi$ and by the converse of the deduction theorem, by MP we have $\Gamma\cup \{\psi\}\vdash \lnot \varphi$
\end{proof}


\defin{Inconsistence}{A set of flas. $\Gamma$ is called inconsistent, if for some (euqivalent to all) fla. $\beta$ it is $\beta, \lnot \beta \in \Thm \Gamma$.}
\note{}{If $\Gamma$ is inconsistent, then for $\alpha\in \Thm \Gamma$.
Then $(\beta \to (\lnot \beta \to \alpha))$ is a tautology. Use $\beta$ from definition of inconsistence and use MP twice.
}

\coroll{(Reductio ad absurdum): If $\Gamma;\varphi$ inconsistent, then $\Gamma \vdash \lnot \varphi$.}
\begin{proof}
    Suppose that $\Gamma;\varphi$ is inconsistent. then for any $\beta$ $\Gamma;\varphi\vdash \beta$ and $\Gamma;\varphi\vdash \lnot \beta$ 
    By the deduction theorem $\Gamma\vdash \varphi\to \beta$ and $\Gamma\vdash \varphi\to \lnot \beta$, therefore 
    $\{\varphi \to \beta, \varphi \to \lnot \beta \}\models_{\text{taut}} \lnot \varphi$
    By Rule T: $\Gamma \vdash \lnot \varphi$.
\end{proof}

\note{}{strategies for finding deductions can be found in the textbook \cite{EndertonHerbertB2001AMIt}.}
\prop{Generalization on constants}{
    Suppose $\Gamma \vdash \varphi$ and $c$ is a constant symbol that does not occur in $\Gamma$.
    Then there is a variable $y$ ($y$ does not occur in $\varphi$) s.th. $\Gamma \vdash \forall y (\varphi)^c_y$.
    and moreover also there is a deduction of $\forall y (\varphi)^c_y$ in which $c$ does not occur.
}{
    We will take a deduction $\langle\alpha_1,\dots \alpha_n \rangle$ of $\varphi$ from $\Gamma$. 
    Pick the variable $y$ as the first variable in any $\alpha_i$ for each $i$.
    \graybf{Claim:} $\langle(\alpha_1)^c_y,\dots (\alpha_n)^c_y \rangle$ is a deduction of $(\varphi)^c_y$ from $\Gamma$.
    \begin{claimproof}
        We need to verify that every member $(\alpha)^c_y$ is actually provable from $\Gamma$.
        \begin{itemize}
            \item if $\alpha_k\in\Gamma$ then $c$ does not occur in $\alpha_k$ then $(\alpha)^c_y = \alpha_k$
            \item if $\alpha_k\in \Lambda$ then $(\alpha_k)^c_y$ is also a logical axiom.
            \item lets say $\alpha_k$ was obtained by $\alpha_i$, $\alpha_i \to \alpha_k$ $i<k$ by MP.
            Now take $(\alpha_i \to \alpha_k)^c_y = (\alpha_i)^c_y\to (\alpha_k)^c_y$. (induction hyphothesis) $(\alpha_k)^c_y$ is obtained from $(\alpha_i)^c_y$ nad $(\alpha_i \to \alpha_k)^c_y$.
            by MP. 
        \end{itemize}
    \end{claimproof}
    Because formal proofs are finite, there is a $\Gamma_0\subseteq \Gamma$ finite such that $\Gamma_0$ consists of the elements of $\Gamma$ used in our deduction 
    $\langle(\alpha_1)^c_y,\dots (\alpha_n)^c_y \rangle$ (is therefore deduction of $(\varphi)^c_y$ from $\Gamma_0$).
    And because we assumed that $y$ does not occur in $\Gamma_0$, so we can use the generalization theorem on $\Gamma_0\vdash (\varphi)^c_y$ and yield $\Gamma_0\vdash \forall y (\varphi)^c_y$ 
}
\subsubsection{Alphpabetic Variants}
We will formalize and proof the statement "You can always rename your bound variables".
Why is that impoirtant? Suppose we want to proof that it is provable that 
$\forall x \forall y P(x,y)\to \forall y P(y,y)$
If we want to use a logical axiom of group 2, we would need to check if $y$ is actually SUB for $x$. We obviously do not have that because $y$ would get bounded.
$\vdash \forall x \forall y P(x,y) \to \forall x \forall z P(x,z)$ 
$\vdash \forall x \forall z P(x,z) \to \forall y P(y,y)$ 
\prop{Existence of alphabetic variants}{
    Let $\varphi$ be a fla., $x$ a variable, $t$ a term. Then there exists a fla. $\varphi'$ 
    such that $\varphi$ differs from $\varphi$ only in the choice of names of the bound variables.
    And \begin{enumerate}
        \item  $\varphi' \vdash \varphi$ as well as $\varphi \vdash \varphi'$
        \item $t$ is SUB for $x$ in $\varphi'$
    \end{enumerate}
}{
    Define $\varphi'$ inductively on complexity of $\varphi$.
    \begin{itemize}
        \item if $\varphi$ is atomic, then $\varphi'= \varphi$
        \item $(\lnot \varphi)' = \lnot \varphi'$ \begin{enumerate}
            \item $\varphi' \vdash \varphi$ and $\varphi \vdash \varphi'$, we want: 
            $\lnot \varphi' \vdash \lnot \varphi$ as well as $\lnot \varphi \vdash \lnot \varphi'$
            Ok by Contraposition.
            \item ok by definition of SUB
        \end{enumerate}
        \item $(\varphi \to \psi)' = \varphi' \to \psi'$
            \begin{enumerate}
                \item By assumption: 
                We want $(\varphi \to \psi )\vdash (\varphi \to \psi)'$, it is enough to show $\varphi \to \psi; \varphi' \vdash \psi'$
                We have \[\begin{aligned}
                    \varphi \to \psi &; \varphi' \vdash \varphi\\
                    \varphi \to \psi &; \varphi' \vdash \psi\\
                \end{aligned}\]
                \item ok by definition of SUB
            \end{enumerate}
        \item $(\forall y \varphi)'$\begin{itemize}
            \item[Case 1:] No occurence of $y$ in $t$. or $x=y$ (that is, $t$ is substitutable for $x$ in $\varphi$). We define $(\forall y \varphi)' = \forall y \varphi'$. All we need to check is part (a). 
                We have that $\forall y \varphi \vdash \varphi$ because $\forall y \varphi \to \varphi$ is an axiom group 2.
                So $\forall y \varphi \vdash \varphi'$ and therefore by the generalization theorem $\forall x \varphi \vdash \forall y \varphi'$
            \item[Case 2:] If $y$ does occur in $t$ and $x\neq y$. let $z$ be the variable that is the first variable that does not occur in $\varphi', x, t$ then set
                $(\forall y \varphi)' = \forall z (\varphi')^y_z$
                \begin{enumerate}
                    \item[2.] want $t$ SUB for $x$ in $(\forall y \varphi)'$ \\
                    $z$ does not occur in $t$ (choice of $z$)
                    $t$ is SUB for $x$ in $\varphi'$. (ind assumption)
                    Then $t$ is SUB fr $x$ in $\forall z (\varphi')^y_z$ iff $t$ is SUB for $x$ in $(\varphi')^y_z$ because $x\neq z$.
                    \item[1.] $\varphi \vdash \varphi'$ (by ind. assumption)
                    Then $\forall y \varphi \vdash \forall y \varphi'$, because
                    \[\vdash \forall y (\varphi \to \varphi')\to (\forall y \varphi \to \forall y \varphi') \text{(axiom of group 3)}\]
                    then \[\forall y (\varphi \to \varphi')\text{gen thm}\]
                    and by MP: \[ \forall y \varphi \to \forall y \varphi'\]
                    
                    We have $\forall y \varphi' \vdash (\varphi')^y_z$ (axiom of group 2, z does not occur in $\varphi'$)
                    By Gen Thm. $\forall y \varphi' \vdash \forall z (\varphi')^y_z$
                    Then 


                    Want $\forall z (\varphi')^y_z \vdash \forall y \varphi$ \\
                    $\forall z (\varphi')^y_z \vdash ((\varphi')^y_z)^z_y$ (ax of group 2.), $y$ is SUB for $z$ in $(\varphi')^y_z$ bc.
                    $\varphi'$ does not contain $z$ so all occurences of $z$ in $(\varphi')^y_z$ are free. (we substituted $z$ for free occ of $y$.)
                    (Re-replacement lemma $ ((\varphi')^y_z)^z_y = \varphi'$ , see problem set.)
                    So we have $\forall z (\varphi')^y_z\vdash \varphi$
                    We also know that $\varphi' \vdash \varphi$ by the inductive hyphothesis. 
                    So $\forall z (\varphi')^y_z \vdash \varphi$
                    So $\forall z (\varphi')^y_z \vdash \forall y \varphi$ (Gen Thm.)
                \end{enumerate}
        \end{itemize}
    \end{itemize}
}
\note{}{$\varphi'$ constructed in proof is also called an alphabetic variant of $\varphi$ }

if our language contains equality:
\begin{enumerate}
    \item $\vdash \forall x x = x$ (ax 5.)
    \item $\vdash \forall x \forall y (x=y \to y = x)$ p.122
    \item $\vdash \forall x \forall y \forall z (x=y \to (y=z \to x = z))$ (Exercise 11. in \cite{EndertonHerbertB2001AMIt})
    \item $\vdash \forall x_1 \forall x_2 \forall y_1 \forall y_2 (x_1=y_1 \to (x_2=y_2 \to (Px_1x_2 \to Py_1y_2)))$, similarly for any $n$-ary predicate. p.128
    \item $\vdash \forall x_1 \forall x_2 \forall y_1 \forall y_2 (x_1=y_1 \to (x_2 = y_2 \to (fx_1x_2 = fy_1y_2)))$, similarly for $n$-ary formula symbol, p.122
\end{enumerate}


\section{Soundness and completeness}
In first order logic it holds:
\begin{itemize}
    \item soundness: If $\Gamma \vdash \varphi$ then $\Gamma \models \varphi$
    \item completeness: If $\Gamma \models \varphi$ then $\Gamma \vdash \varphi$
\end{itemize}
For the proof of soundness we will have to show that all our axioms are valid. For this we will need the following two lemmas.
\lemma{pre-substitution lemma}{Let be a map TODO}{}
\lemma{Substitution lemma}{If $t$ SUB $x$ in $\varphi$ then $\mathcal{A}\models \varphi_t^x\: [s]$ iff $\mathcal{A}\models \varphi\: [s(x|\overline{s}(t))]$}{
    \begin{enumerate}
        \item $\varphi$ atomic: use pre-substitution lemma.
        \item $\varphi$ is of the form $\lnot \psi$ or $\psi \to \theta$ - use induction
        \item $\varphi$ is of the form $\forall y \psi $ and $x$ does not occur free in $\varphi$\\
        $\varphi^x_t = \varphi$ wts. $\mathcal{A}\models \varphi_t^x\: [s]$ iff $\mathcal{A}\models \varphi\: [s(x|\overline{s}(t))]$\\
        By \ref{Thm.evalonlyfreevar}, this is indeed the case, so the lemma holds.
        \item $\varphi$ is $\forall y \psi$ where $x$ occurs free in $\varphi$ and $t$ is SUB for $x$ in $\varphi$.
        Then it must be: $y$ does not occur in $t$ and $t$ is SUB for $x$ in $\psi$.\\
        then $\overline{s}(t) = \overline{s(y|a)}(t)$ for every $a\in A$. Moreover we also have, that $\varphi^x_t = \forall y \psi^x_t$ bc. $x\neq y$\\
        Then $\mathcal{A}\models \varphi_t^x \: [s]$ iff $\mathcal{A}\models \forall y \psi_t^x \: [s]$\\
        iff $\mathcal{A}\models \psi_t^x \: [s(y|a)]$ and for all $a\in A$.\\
        iff $\mathcal{A}\models \psi \: [s(y|a)(x|\overline{s(y|a)}(t))]$ (inductive assumption) and for all $a\in A$\\
        By above: iff $\mathcal{A}\models \psi \: [s(y|a)(x|\overline{s}(t))]$ for all $a\in A$\\
        iff $\mathcal{A}\models \forall y \psi \: [s(x|\overline{s}(t))]$
    \end{enumerate}
}


\prop{}{If $\Gamma \vdash \varphi$ then $\Gamma \models \varphi$}{
    Proof by induction on $\varphi$.
    We have to show: 
    \begin{enumerate}
        \item that every logical axiom is valid
        \item logical implication is preserved by MP
    \end{enumerate}
    \begin{enumerate}
        \item[2.] Assume 1. we have to show that if  $\Gamma \vdash \varphi$ then $\Gamma \models \varphi$
        \begin{itemize}
            \item $\varphi\in \Lambda$ by 1.
            \item $\varphi \in \Gamma$ then $\Gamma \models \varphi$
            \item $\varphi$ follows by MP from $\psi,\psi \to \varphi$ then by assumption $\Gamma\models \psi$ and $\Gamma\models \psi \to \varphi$
            Therefore $\Gamma\models \varphi$
        \end{itemize}
        \item[1.] Exercise 6 in section 2.2 consists in showing that if a logical axiom is valid, then also its generalization.
        So generalizations of valid formulas are valid, we therefore may only consider logical axioms that are not generalizations of another logical axiom.
        \begin{enumerate}
            \item[Ax of 1.] exercise 3, section 2.3
            \item[3.] exercise 3, section 2.2
            \item[4.] exercise 4, section 2.2
            \item[5.] $x=x$: $\mathcal{A}\models x = x[s]$ because $s(x) = s(x)$
            \item[6.] $x=y \to (\alpha \to \alpha')$ where $\alpha$ is atomic fla, and $\alpha'$ is obtained from $\alpha$ by remplacing some occurances of $x$'s with $y$'s.
            By the deduction theorem, is enough to show that the set of formulas $\{x=y, \alpha\}\models \alpha'$.
            Let $\mathcal{A}$ be a structure, $s$ an assigment such that $\mathcal{A}\models x=y [s]$\\
            \graybf{Claim: } for every term $t$ if $t'$ is obtained from $t$ by replacing some $x$'s by $y$'s, then $\overline{s}(t) = \overline{s}(t')$.
            \begin{claimproof}
                Induction on terms.
            \end{claimproof}
            \begin{itemize}
                \item $\alpha$ of the form $t_1 = t_2$ then $\alpha'$ is $t_1' =t_2'$, use prev. claim.
                \item $\alpha$ of the form $P t_1 \dots t_n$ similar
            \end{itemize}
            \item[2.] wts. $\forall x \varphi \to \varphi^x_t$ is valid, where $t$ is SUB for $x$ in $\varphi$.\\
            simple case: $\forall x Px \to Pt$ is valid.
            Let $\mathcal{A}\models \forall x P x [s]$ then $\mathcal{A}\models \forall x P x [s(x|a)]$ for every $a\in A$. so i.p. for $a = \overline{s}(t)$
            this means $\overline{s}(t)\in P^\mathcal{A}$ that is $\mathcal{A}\models Pt$.
            In more generality we will need the substitution lemma:
            We have $\mathcal{A} \models \forall x \varphi \: [s]$\\
            this is equivalent to $\forall a \in A$ we have $\mathcal{A}\models \varphi [s(x|a)]$ 
            then in particular $\mathcal{A}\models \varphi [s(x|\overline{s}(t))]$ and
            by the substitution lemma we have the equivalence to $\mathcal{A}\models \varphi^x_t\:[s]$
        \end{enumerate}
    \end{enumerate}
}

\coroll{$ \vdash \varphi \leftrightarrow \psi$ then $\varphi,\psi$ are logically equivalent.}
\coroll{$\varphi'$ an alphabetic variant of $\varphi$ then $\varphi,\varphi'$ are logically equivalent.}
\defin{}{A set of formulas $\Gamma$ is called satisfiable, whenever there is a structure $\mathcal{A}$ with an assigment into $A$ that for all $\sigma\in \Gamma$
    $\mathcal{A}\models \sigma \: [s]$
}

\coroll{If $\Gamma$ is satisfiable then $\Gamma$ is consistent}
\note{}{This corollary is equivalent to Soundness (Exercise)}

\subsubsection{completeness}
\prop{Completness Theorem}{$\Gamma \models \varphi \implies \Gamma \vdash \varphi$ }{}

\prop{Completness Theorem'}{Every consistent set of formulas is satisfiable.}{}

\note{}{
    \begin{itemize}
        \item The completeness Theorem is equivalent to completeness theorem'
        \item The completeness Theorem holds for language of any cardinality.
        \item We will assume for simplicity that the Language is countable.
    \end{itemize}
}
\begin{proof}
    Let $\Gamma$ be a consisten t set of flas in some language $\mathcal{L}$
    The idea of the proof:
    \begin{itemize}
        \item 1.-3. build a new set of formulas $\Delta$
        \begin{itemize}
            \item $\Gamma \subseteq \Delta$
            \item $\Delta$ consistent and maximal
            \item For every fla $\varphi$ and every variable $x$ there is constant $c$ $\lnot \forall x \varphi\to \lnot \varphi^x_c\in \Delta$
        \end{itemize}
        \item 4. Build $\mathcal{A}$ by $A$ is the set of terms (in expanded language) such that
        Every fla in $\Delta$ w/o. equality ($=$) is satisfiable in $\mathcal{A}$
        \item accomodate $=$
    \end{itemize}
    \begin{enumerate}
        \item Add a countable infinite set of new constant symbols to the language $\mathcal{L}$ and call it $\mathcal{L}'$\\
        \graybf{Claim: }$\Gamma$ is a consistent set of flas. in $\mathcal{L}'$.
        \begin{claimproof}
            Why? If not, then $\Gamma\vdash \beta \land \lnot \beta$ where deduction is in $\mathcal{L}'$ 
            and there occurs finitly many new constant symbols in this deduction.
            By generalization on constants the new constants in the proof can be replaced by new variables. We get a 
            deduction in the old language $\mathcal{L}$ and that contradicts the assumption that $\Gamma$ is consistent.
        \end{claimproof}
        \item Want to add for every formula $\varphi$ and every variable $x$ $\lnot \forall x \varphi\to \varphi^x_c$ \\
        and need to stay consistent. Fix enumeration of pairs $(\varphi, x)$ where $\varphi'$ is a $\mathcal{L}'$-fla., $x$ variable.
        $$\theta_1 \defeq \forall x_1 \varphi_1 \to \lnot{\varphi_1}^{x_1}_{c_1}$$
        where $c_1$ is the first new constant that does not occur in $\varphi_1$
        \vdots
        $$\theta_n \defeq \forall x_n \varphi_n \to \lnot{\varphi_n}^{x_n}_{c_n}$$
        where $c_n$ is the first new constant that does not occur in $\varphi_n$ and does not occur in $\theta_k$ for $k<n$.\\
        $\Theta = \{\theta_1,\dots \}$\\
        \graybf{Claim:} $\Gamma \cup \Theta$ is consistent.
        \begin{claimproof}
            Suppose it is not. Then let $m$ be minimal such that $\Gamma\cup \{\theta_1 \dots \theta_{m+1}\}\vdash \beta \land \lnot \beta$.
            Then by (Raa) $\Gamma\cup \{\theta_1 \dots \theta_{m}\}\vdash \lnot \theta_{m+1}$
            $\theta_{m+1}$ is of the form $$\forall x_m \varphi_m \to \lnot{\varphi_n}^{x_m}_{c_m}$$
            then by (Rule T) $$\Gamma\cup \{\theta_1 \dots \theta_{m}\}\vdash \lnot \forall x \varphi$$ and 
            $$\Gamma\cup \{\theta_1 \dots \theta_{m}\}\vdash \varphi_c^x$$ (star..TODO)
            
            %($\lnot (\alpha \to \beta)\models_{\text{taut}}\alpha\land \lnot \beta$)
            star: $\Gamma \cup \{\theta_1,\dots \theta_m\}\vdash \forall x \varphi$
            By generalization on constants:
            $\Gamma \cup \{\theta_1,\dots \theta_m\}\vdash \forall x (\varphi_c^x)^c_x$
            since $c$ does not occur on the left.
            also $(\varphi^x_c)^c_x = \varphi$ bc $c$ does not occur in $\varphi$.
            Now we have 
            $$\Gamma\cup \{\theta_1 \dots \theta_{m}\}\vdash \lnot \forall x \varphi$$
            and 
            $$\Gamma \cup \{\theta_1,\dots \theta_m\}\vdash \forall x (\varphi_c^x)^c_x$$ 
            which is a contradiction to minimality of $m$ or the consistentness of $\Gamma$.
        \end{claimproof}
        \item Extend $\Gamma \cup \Theta$ to maximal consistent set.
        $\Lambda$ is the set of logical axioms in $\mathcal{L}'$ we know that $\Gamma\cup \Theta$ is consistent. so we know that there is no $\beta$ 
        \[\Gamma \cup \Theta \cup \Lambda  \models_{\text{taut}} \beta \land \lnot \beta\]
        So we find $v$ a truth assigment on prime flas. that satisfies $\Gamma \cup \Theta \cup \Lambda$ and we are going to use this truth assigment to find the maximal set 
        \[\Delta \defeq \bigl\{\varphi : \overline{v}(\varphi)=1\bigr\}\]
        Then for every $\varphi$ either $\varphi\in \Delta$ or $ \lnot \varphi\in \Delta$ so we have maximality and we also have consistency bc.
        $\Delta \vdash \varphi$ then $\Delta \models_{\text{taut}} \varphi$ because $\Lambda\subseteq \Delta$ and that means 
        $\overline{v}(\varphi)=1$ so $\varphi\in \Delta$.
        So we have that $\Delta$ is consistent. and we say that $\Delta$ is deductively closed i.e. $\Delta\vdash \varphi$ then $\varphi \in \Delta$.
        \item Construction of an $\mathcal{L}'$ structure $\mathcal{A}$ from $\Delta$.
        We will firstly replace $=$ with $E$ bin. predicate symbol.
        $A=$ set of all $\mathcal{L}'$-terms\\
        $E^\mathcal{A}$ def. by $uE^\mathcal{A} t \iif u=t\in \Delta $\\
        $f^\mathbf{A}$ def by $f^\mathbf{A}(t_1,\dots t_n) = ft_1\dots t_n$\\
        $c^\mathcal{A} \defeq c$\\
        $P^\mathcal{A}$ then $P^\mathcal{A}t_1,\dots t_n$ iff $Pt_1\dots t_n\in \Delta$
        We take the assignment $s:Var \to A$ by $s(x) = x$\\
        \graybf{Claim 1: } $\overline{s}(t) = t$ for every term $t$
        \graybf{Claim 2: } for every $\varphi$ let $\varphi^*$ be obtained from $\varphi$ by replacing each $=$ with $E$ then $\mathcal{A}\models \varphi^* \: [s] \iif \varphi \in \Delta$
        \begin{claimproof}
            \begin{itemize}
                \item $\varphi$ atomic then $\varphi$ is $Pt$\\
                \[\mathcal{A}\models \varphi^* \: [s] \iif \mathcal{A}\models Pt \: [s] \iif \overline{s}(t)\in P^\mathcal{A} \iif t\in P^\mathcal{A}\]
                $\varphi$ is $uEt$ then
                \[\mathcal{A}\models \varphi^* \: [s] \iif \mathcal{A}\models uEt \: [s] \iif \overline{s}(u)E\overline{s}(t)\iif u=t\in \Delta\]
                \item $\lnot \varphi$
                \[\mathcal{A}\models \lnot\varphi^* \: [s] \iif \mathcal{A}\vDash \varphi \: [s] \iif \varphi\notin \Delta \iif \lnot \varphi \in \Delta\]
                \item $\varphi \to \psi$
                \[\mathcal{A}\models \varphi^*\to \psi^* \: [s] \iif \mathcal{A}\vDash \varphi^* \: [s] \text{ or }\mathcal{A}\models \psi^* \: [s] \iif \mathcal{A}\models \lnot \varphi^* \: [s] \text{ or }\mathcal{A}\models \psi^* \: [s] \iif \lnot \varphi \in \Delta \text{ or } \psi\in \Delta \iif (\varphi \to \psi)\in \Delta\]
                \item $\forall x \varphi$
                wts. $\mathcal{A}\models \forall x \varphi^* \: [s] \iif \forall x \varphi \in \Delta$
                Suppose $\mathcal{A}\models \forall x \varphi^* \: [s]$ then $\mathcal{A}\models \varphi^* \: [s(x|c)]$ where $c$ is such that $\lnot \forall x \varphi \to \lnot \varphi^x_c\in \Delta$
                Provided that we have substitutability we have by substitution lemma %and soundness theorem
                we know $\mathcal{A} \models (\varphi^x_c)^*\: [s]$
                By the inductive hyphothesis $\varphi^x_c\in \Delta$ and $\lnot\varphi_c^x\notin \Delta$ 
                so we do not have $\lnot \forall x \varphi\notin \Delta$ and by maximality of $\Delta$ we have 
                $ \forall x \varphi \in \Delta$.

                Suppose $\mathcal{A}\vDash \forall x \varphi^* \: [s]$ then $\mathcal{A}\vDash \varphi^* \: [s(x|t)]$ for some $t$. By the substitution lemma (providet that $t$ is SUB for $x$ in $\varphi$) we can replace $x$ by $t$ in the formula.

                $\mathbf{A} \vDash (\varphi^x_t)^*\:  [s]$ by the inductive hyphothesis $\varphi^x_t\notin\Delta$ then $\forall x \varphi \notin \Delta$ becasue $\Delta$ is deductively closed.
                If $t$ is not SUB for $x$ in $\varphi$, we know that there exists a logically equivalent alphabetic variant $\varphi'$ of $\varphi$ such that $t$ is SUB for $x$ in $\varphi'$.
            \end{itemize}
        \end{claimproof} 
        So at this point we have: 
        If $\mathcal{L}$ does not contain $=$ then take $\mathcal{A}$ reduction to $\mathcal{L}$ and $\mathcal{A}$ w/s satisfies $\Delta$.
        \item Define $\mathcal{A}/E$ and assigment \\
        \graybf{Claim: } $E^\mathcal{A}$ is a congruence on the structure $\mathcal{A}$ compatible with the predicates and formulas.
        \begin{itemize}
            \item $E^\mathcal{A}$ is equivalence relation
            \item $P^\mathcal{A}$ compatible w/ $E^\mathcal{A}$ i.e. $P^\mathcal{A}t_1,\dots t_n \iif P^\mathcal{A} s_1,\dots s_n$ whenever $t_i E^\mathcal{A} s_i$ for all $1\leq i \leq n$.
            \item $f^\mathcal{A}$ compatible w/ $E^\mathcal{A}$ i.e. $f^\mathcal{A}(\underline{t})E^\mathcal{A} f^\mathcal{A}(\underline{s})\iif \underline{t}E^\mathcal{A}\underline{s}$
        \end{itemize}
        \defin{}{$\mathcal{A}/_E$ is the structure w/ universe $A/_E$ and $([t_1],\dots [t_n])\in P^{\mathcal{A}/_E} $ iff $(t_1,\dots t_n)\in P^\mathcal{A}$
            $f^{\mathcal{A}/_E}([t_1],\dots [t_n]) = [f^\mathcal{A}(t_1,\dots t_n)]$
            Let $h:A \to A/_E: t\mapsto [t]$ quotient map. note $h$ is surjective. $E^{A/_E}$ realized by equality on $A/_E$:
            $[t]E^{\mathcal{A}/_E}[s]$ iff $t E^\mathcal{A} s$ iff $[t] = [s]$ 
        }
        \graybf{Claim:} $\mathcal{A}/_E$ satisfies $\Delta$ w/ $h\circ s$.
        \begin{claimproof}
            Let $\varphi\in \Delta$, $\mathcal{A}\models \varphi^*[s]$ by (4)
            Want to show $\mathcal{A}\models \varphi^*[s] \iif \mathcal{A}/_E \models \varphi^* [h\circ s]$ by Homomorphism Thm.($\varphi^*$ has no occurence of $=$, surjectivity)
            realisation of $E$ in $A/_E$ is the equality in $A/_E$.
            Take the reduct of $\mathcal{A}/_E$ to $\mathcal{L}$. 
        \end{claimproof}
    \end{enumerate}
\end{proof}

Exam exam


\coroll{compactness statements 
\begin{enumerate}
    \item $\Gamma \models \varphi$ then there is a finite subset $\Gamma_0\subseteq \Gamma$ s.th. $\Gamma_0\models \varphi$
    \item every finitly satisfiable set of formulas is satisfiable
\end{enumerate}
}
\begin{proof}
    \begin{enumerate}
        \item $\Gamma\models \varphi$ then by completeness $\Gamma \vdash \varphi$ where the deduction uses only formulas 
        from some $\Gamma_0\subseteq \Gamma$ finite. By soundness, $\Gamma_0\models \varphi$
        \item $\Gamma$ finitly satisfiable. Suppose $\Gamma$ is not satisfiable then by completeness $\Gamma$ is not consistent.
        So there has to be some $\Gamma_0\subseteq \Gamma$ such that $\Gamma_0\vdash \beta \land (\lnot \beta)$ so $\Gamma$ is not finitly satisfiable (by soundness).
    \end{enumerate}
\end{proof}




\subsection{Sizes of models}
Let $\Gamma$ be a consistent set of formulas. Is it possible to 

\bsp{}{
    \begin{enumerate}
        \item For each $n\in \NN$ there is $\Gamma$ such that all models of $\Gamma$ that have size $n$.
        \item DLO (Dense liniear order) w/o endpoints: no finite models
    \end{enumerate}
}
\lemma{}{
    $\Gamma$ such that all models are finite. Then there has to be 
    $m\in\NN$ such that $|\mathcal{A}|\leq m$ for every model 
    $\mathcal{A}\in\Mod\Gamma$}{
    
}{  Suppose $\Gamma$ has models of arbitrarily large finite size. \\
    Idea: Expand language by new constant symbols $c_0,c_1,\dots$.
    \[\theta_1 \defeq \ c_0 \neq c_1\]
    \[\theta_2 \defeq \ c_0 \neq c_1 \land c_1\neq c_2 \land c_0 \neq c_2 \]
    \vdots
    \[\theta_n \defeq \ \bigwedge_{i,j=0 i\neq j}^{n}c_i\neq c_j\]
    \[\Theta \defeq \{\theta_1, \theta_2 \dots \}\]
    $\Gamma\cup \theta$ finitely satisfiable.
    By the compactness theorem there exists a $\Theta_0\subseteq \Theta$ finite TODO. then there is a maximal element $\theta_k$
    By the compactness theorem reduct to language of $\Gamma$ is an infinite models 
    of $\Gamma$ which is a contradiction to all models of $\Gamma$ are finite.
}

\note{}{There is no sentence in the language of groups / rings /\dots that would be satisfied in all finite 
    groups/rings/\dots and not satisfied in all infinite groups/rings/\dots}



Recall the proof of completeness theorem. $\mathcal{L}$, $|\mathcal{L}= \aleph_0$
$\Gamma$ consistent set of $\mathcal{L}$-formulas. $\mathcal{A}/_E$ countable.


\subsection{Completness for uncountable languages}

Use (AC) in the form of Zorn's Lemma and Zermelo's Theorem
\prop{Zorn's Lemma}{$P$ partially ordered set such that every chain has an upperbound in $P$ then $P$ contains a maximal element.}{}
\prop{Zermelos's Theorem}{Every set can be well-ordered. That is linearly ordered such that every non-empty set has a smallest element.}{}
$\omega$ is the first infinite ordinal. then it is also a cardinal and is called $\aleph_0$

\[A_0 = \{(\varphi_\alpha, x_\alpha): \alpha < \lambda\}\]

\vdots

\[|\mathcal{A}/_E | \leq \lambda\]

\section{Model Theory}
\subsection{Lwenheim-Skolem-Theorem}
\prop{}{Supposee $\Gamma$ is a set of $\mathcal{L}$-formulas. $|\mathcal{L}| = \lambda$ and lets assume 
    $\Gamma$ is satisfiable in some infinite structure.\\
    Then for every cardinal $\kappa\geq \lambda$, $\Gamma$ is satisfiable in a structure of cardinality $\kappa$.
}{
    add $\kappa$ many new constants to the language $\mathcal{L}$.

    $\mathcal{L}' = \mathcal{L}\cup \{c_\alpha : \alpha < \kappa\}$

    $\Sigma = \{c_\alpha \neq c_\beta : \alpha\leq \beta, \ \alpha,\beta\leq \kappa\}$

    Then $\Gamma\cup \Sigma$ is finitly satisfiable in $\mathcal{L}'$.
    This is because $\Gamma$ is satisfiable in some infinite structure. By compactness $\Gamma\cup \Sigma$ is satisfiable.
    We have $\mathcal{A}\models \Gamma \cup \Sigma$ then $|\mathcal{A}|\geq \kappa$.

    By the proof of completeness theorem, $\Gamma\cup \Sigma$ has a model of size $\leq \kappa$.
    Hence it is exactly of size $\kappa$. Take reduct TODO
}
\bsp{}{Language of ZFC $\mathcal{L} = \{\in\}$ is countable. Lwenheim-Skolem guaranties that ZFC has a countable model.
    called skolems paradox. 
    ZFC knows that there are uncountable sets.
    explanation: some bijections are missing 
}
\bsp{}{\label{ComplNotImplyCath}\begin{enumerate}
    \item $\overline{\RR}$ real field. $\Thm(\overline{\RR})$ has a countable model. $\RR_\text{alg}$
    \item $\mathcal{N} = (\NN,0,S,+,\cdot)$\\
    Claim: there exists a countable structure $\mathcal{M}$ such that $\mathcal{N}\equiv \mathcal{M}$ but $\mathcal{N}\ncong \mathcal{M}$
    One way is to add new constant c to language
    $\Sigma = \{0<c, S0<c,\dots\}$ is fin satisfiable. So $\Sigma\cup Th (\mathcal{N})$ is fin satisfiable by compactness it is satisfiable

    Take the reduct to original language. $\mathcal{M}$. and $\mathcal{M}$ not isomorphic to $\mathcal{N}$, bc
    A bijection of $M\to \NN$ would have to map $c$ somewhere but for every $S^k0<c$ for every $k$ wont be preserved by any map.
\end{enumerate}
}
\subsection{Theories and completeness}
\defin{Theory}{A theory $T$ is a set of sentences that is closed under logical implication.
\[T\models \sigma \implies \sigma \in T\]
}
\note{}{If $\mathcal{L}$ is a language. Then 
\begin{itemize}
    \item there is a smallest $\mathcal{L}$-theory. The set of all valid $\mathcal{L}$-sentences.
    \item and also a largest $\mathcal{L}$-theory. The set of all $\mathcal{L}$-sentences.
\end{itemize}
}


\defin{}{$\mathcal{K}$ some class of $\mathcal{L}$- structures. Then $\Th(\mathcal{K}) = {\sigma : \sigma \text{ $\mathcal{L}$-sentence and for every $K \in \mathcal{K}$ } \sigma\in \Th(K)}$}
\note{}{$\Th(\mathcal{K})$ is a theory. 
\[\Th(\mathcal{K})\models \sigma then  \sigma\in \Th(\mathcal{K}) \]
}

\bsp{}{

\begin{itemize}
    \item $\mathcal{L} = \{0,1,+,\cdot,-\}$ $\mathcal{F}$ the class of fields then $\Th(\mathcal{F})$ is the set of sentences truein every field.
\end{itemize}
}
Recalll $\Mod(\Sigma)$ is the class of all models of $\Sigma$.
$\Th(\Mod \Sigma)$ might not be the set $\Sigma$ but it is the set of all 
sentences true in all models of $\Sigma$.

The set of all sentences that are logically implied by $\Sigma$ 

The set of all consequences of $\Sigma$ $\eqdef C_n(\Sigma)$

\note{}{$\Sigma$ is a theory iff $C_n(\Sigma) = \Sigma$}

\defin{}{We say that a theory $T$ is complete, if for every sentence 
$\sigma$ either $\sigma\in T$ or $\lnot \sigma\in T$.}

\bsp{}{
    $\mathcal{A}$ a $\mathcal{L}$-structure, then $\Th(\mathcal{A})$ is complete.
}

\note{}{$\Th(\mathcal{K})$ is complete, iff any $K_1,K_2\in \mathcal{K}$ are elementarily equivalent.

A theory $T$ is complete iff any to models are elementarily equivalent.
}

\bsp{}{
    \begin{itemize}
        \item The theory of fields is not complete.
        \item The theory of algebraically closed fields of characteristic $0$ is complete 
        (That is non-trivial)
    \end{itemize}
}
\defin{axiomatizability}{
    \begin{itemize}
        \item A theory $T$ is finitely axiomatizable if there is a sentence 
        $\sigma$ such that $C_n(\sigma) = T$.
        \item A theory $T$ is axiomatizable, if there is a decidable set 
        $\Sigma$ such that $C_n(\Sigma) = T$.
    \end{itemize}
}
\bsp{}{
    \begin{itemize}
        \item The theory of fields (common theory of all fields) is finitely axiomatizable.
        \item Theo theory of fields of characteristic $0$ is axiomatizable. $\Psi\cup \{1+1\neq 0, 1+1+1\neq 0,\dots\}$ 
        It is however not finitely axiomatizable. If 
        $\Psi_0\subseteq \Psi\cup \{1+1\neq 0, 1+1+1\neq 0,\dots\}$ 
        finite, then $\Psi_0$ has a model of characteristic $p$ for some sufficiently large $p$.
    \end{itemize}
}
\prop{}{If $C_n(\Sigma)$ is finitlely axiomatizable then there exists a finite subset           
    $\Sigma_0\subseteq \Sigma$ such that $C_n(\Sigma_0) = C_n(\Sigma)$}{
    Suppose $C_n(\Sigma)$ is finitely axiomatizable. So $C_n(\sigma) = C_n(\Sigma)$. 
    Then there is a finite subset $\Sigma_0\subseteq \Sigma$ such that $\Sigma_0 \models \sigma$.
    And we get $C_n(\Sigma_0) = C_n(\Sigma)$
}
\defin{}{A theory $T$ is $\aleph_0$-categorical, if any two infinite countable models of 
    $T$ are isomorphic.
    Futhermore for some infinite cardinal $\kappa$ a theory $T$ is called $\kappa$-categorical, if every two models of cardinality $\kappa$ are isomorphic.
}
\prop{Los-Vaught test}{For a theory $T$ in a countable language with only infinite models it holds\\
    If $T$ is $\kappa$-categorical for some infinite cardinality $\kappa$ then $T$ is complete.
}{
    Let $T$ be $\kappa$-categorical.
    Want: If $\mathcal{A},\mathcal{B}\models T$ then $\mathcal{A}\equiv \mathcal{B}$.
    Note: both $\mathcal{A}$ and $\mathcal{B}$ are infinite.
    By LST there exists structures $\mathcal{A}'$ and $\mathcal{B}'$ with $\mathcal{A}\equiv \mathcal{A}'$ and $\mathcal{B} \equiv \mathcal{B}'$ and $|\mathcal{A}'|, |\mathcal{B}'| = \kappa$.
    By $\kappa$-categorical we have $\mathcal{A}' \cong \mathcal{B}'$ so $\mathcal{A}\equiv \mathcal{B}$
}
\note{}{completness does not imply categorical.
\begin{itemize}
    \item The theory of natural numbers is not $\aleph_0$-categorical. See Example \ref{ComplNotImplyCath}
    \item RCF not $\kappa$-categorical for all infinite cardinalities $\kappa$
    Not $\aleph_0$ categorical real clo of $\mathbb{Q}(\pi)$, real closure of $\mathbb{Q}$
    not uncountable categorical $\overline{\mathbb{R}}$, $\overline{\mathbb{R}(\varepsilon)}, 0<\varepsilon <\frac{1}{n}$ for every $n\in \NN$.
\end{itemize}
}
\subsection{Theory of algebraic closed fields}
\prop{}{The theory of algebraic closed fields of characteristic $p$ ACF$_p$, where $p$ is either $0$ or prime is complete.}{
\begin{itemize}
    \item  countable language
    \item no finite models
\end{itemize}
Let $\mathcal{K}_1,\mathcal{K}_2\models \text{ACF}_p$ such that $|K_1| = |K_2|=\kappa$ uncountable.
$F_1$ prime field of $\mathcal{K}_1$, $F_2$ prime field of $\mathcal{K}_2$.

Note $F_1, F_2$ are determined by $p$ if $p=0$ then $F_1 = F_2 = \mathbb{Q}$ and if $p$ prime then $F_1 = F_2 = \mathbb{F}_p$

Define $F \defeq F_1 = F_2$.
$B_1$ trancendence base of $\mathcal{K}_1$ over $F$ 
$B_2$ trancendence base of $\mathcal{K}_2$ over $F$ 
\begin{itemize}
    \item $B$ is trancendence base of $K$ over $F$ if $B$ is a $\subseteq$-maximal subset of $K$ which is algebraically closed then 
    \item $B\subseteq K$ is algebraically TODO
\end{itemize}
$F(B_1)$, $F(B_2)$ subfields of $\mathcal{K}_1,\mathcal{K}_2$
\begin{itemize}
    \item alg cl $F(B_1) = \mathcal{K}_1$
    \item alg cl $F(B_2) = \mathcal{K}_2$
\end{itemize}
Fact: Let $F$ subfield of $K$. if $F$ is countable and $K$ uncountable, then any transe basis $B$ of $K$ oer $F$ is of cardinality $|K|$, hence uncountable.

Steinitz: Two ACF are isomorphic iff they have the same characteristic and there trancendence spaces have the same cardinality.
}
\subsubsection{Lefschetz Principle}
\prop{Lefschetz Principle}{Let $\mathcal{C} = (\mathbb{C},0,1,+,\cdot,-)$ For a sentence in the language of $\mathcal{C}$
    Then the following are equivalent:
    \begin{itemize}
        \item $\mathcal{C}\models \sigma$
        \item $\mathcal{A}\models \sigma $ for every $\mathcal{A}\models $ ACF$_0$
        \item ACF$_0$ $\models \sigma$
        \item for all sufficiently large primes $p$ ACF$_p$ $\models \sigma$
        \item For infinitely many primes $p$ ACF$_p$ $models \sigma$
    \end{itemize}}{ 

    \begin{itemize}
        \item[(a), (b), (c)] are equivalent by completeness of ACF$_0$
        \item[(c)$\implies$ (d)] ACF$_0$ $\models \sigma$ 
        so there is $T_0\subseteq \text{ACF}_0$ such that $T_0\models \sigma$ therefore there exists a sufficiently large prime $p$ such that $\text{ACF}_p\models \sigma$. 
        \item[(d) $\implies$ (e)]
        \item[(e) $\implies$ (c)] If $\text{ACF}_0\vDash \sigma$ than $\text{ACF}_0\models \sigma$
    \end{itemize}
}
Example of the Lefschetz Principle:
\prop{Ax}{
    Let $f:\mathbb{C}^n \to \mathbb{C}^n$ be a polynomial map. If $f$ is injective, then $f$ is surjective.
}{
    Our language is $\mathcal{L} = \{0,1,+,-,\cdot\}$. Note that there is an $\mathcal{L}$-sentence $\Phi_d$ such that a Field $F$ 
    
    $F\models \Phi_d$ iff for every polynomial map $f:F^n\to F^n$ whose TODO coord. function is of degree at most $d$, if $f$ is injective then $f$ is surjective.

    By Lefschetz principle it is enough to show for sufficiently large 
    primes $p$, $\text{ACF}_p\models \Phi_d$ for all $d\in \NN$.
    Since $\text{ACF}_p$ is complete, it is enough to show that every injective polynomial map $f:K^n\to K^n$ is surjective, where $K = TODO$
    Let $f:K^n\to K^n$ be a polynomial map.

    Then there is a finite subfield $K_0$ of $K$ such that all coefficients of $f$ come from $K_0$.
    Let $y\in K^n$. Then there is a finite subfield $K_1$ of $K$ such that $y\in K_1$ and $K_0\subseteq K_1 \subseteq K$. Since $f:K^n_1\to K^n_1$ is injective and $K_1$ finite, $f|_{K_1}$ is surjective onto $K_1$. So there is $x\in K_1^n$ such that $f(x)=y$.
}
\note{}{Later, a purely geometric proof was found by Borel.}

Another use of \L o-Vaught

\prop{}{\[(\mathbb{Q},<_\mathbb{Q}) \equiv (\RR, <_\RR)\]}{
    $\mathcal{L} = \{<\}$ and note that both $(\mathbb{Q},<_\mathbb{Q}), (\RR, <_\RR)$ are DLO without endpoints, i.e. they satisfy the following axioms
    \begin{enumerate}
        \item $\forall x \forall y (x<y\lor x=y\lor y<x)$
        \item $\forall x \forall y (x<y\to \lnot(y<x))$
        \item $\forall x \forall y \forall z ((x<y\land y<z)\to x<z)$
        \item $\forall x \forall y (x<y\to \exists z(x<z\land z<y))$
        \item $\forall x \exists y \exists z (y<x\land x<z)$
    \end{enumerate}
    TODO
}

\subsection{Nonstandard Analysis}
%TODO historical background
\begin{enumerate}
    \item Language $\mathcal{L}$: $=$, $\forall$ ranging over $\RR$,
    \begin{itemize}
        \item $P_R$ TODO
    \end{itemize}
    \item standard structure for $\mathcal{L}$: $\mathcal{R}$ with universe $\RR$, $c_r^\mathcal{R} = r$, $P_R^\mathcal{R} = R$, $f^\mathcal{R}_F = F$.
    \item Nonstandard structure for $\mathcal{L}$: $\mathcal{R}^*$, which is constructed using the compactness theorem 
    \[\Gamma \defeq \Th(\mathcal{R}) \cup \{c_r P_< v_1 : r\in \RR\}\]
    Compactness theorem $\implies$ there exists a $\mathcal{L}$-structure $\mathcal{R}^*$ with $\mathcal{R}^*\models \Gamma [(v_1 | a)]$ for some $a\in R^*$. We have $\mathcal{R}\equiv \mathcal{R}^*$.
    Moreover, $h: \RR \to R^*$ defined by $r\mapsto c_r^*$ is an isomorphism of $\mathcal{R}$ into $\mathcal{R}^*$
    \begin{itemize}
        \item $h$ is injective:
        \item TODO
    \end{itemize}
\end{enumerate}
\note{}{WMA $\mathcal{R}$ substructure of $\mathcal{R}^*$ (se PS)}
Notation: We will write $\!^*B$ instead of $P_B^{\mathcal{R}^*}$.
\bsp{}{what is $\!^*\RR$?
We have that $\mathcal{R}\models \forall x P_\RR$, hence $\mathcal{R}^*\models \forall x \!^*\RR$, so $\!^*\RR = R^* = \text{universe of } \mathcal{R}^*$.
\note{}{
    Let $F$ be an $n$-ary operator on $\RR$. Then $F$ is the restriction of $\!^*F$ to $\RR$. $\!^*c_r = r$.
}
Idea: If we want to show that $\!^*R$ or $\!^*F$ has certain property, then we show
\begin{itemize}
    \item $R$ or $F$ have that property.
    \item property can be expressed in $\mathcal{L}$
\end{itemize}
}
TODO

%26.11.2024
$\mathcal{R}^*\supseteq \mathcal{R}$ such that $\mathcal{R}^*\equiv \mathcal{R}$.
$\mathcal{F} = \{x\in \mathcal{R}^* : \exists r\in \RR \: ^*|x|^* \leq r\}$
$\mathcal{I} = \{x\in \mathcal{R}^* : \forall r\in \RR \: ^*|x|^* < r\}$
\prop{}{
    \begin{enumerate}
        \item $\mathcal{F}$ is a subring of $\mathcal{R}^*$
        \item $\mathcal{I}$ is an ideal in $\mathcal{R}*$
    \end{enumerate}
}{
    \begin{enumerate}
        \item Let $x,y\in \mathcal{F}$ then there exists $a,b\in \RR^{>0}$ such that $^*|x|^* \leq a$ and $^*|y|^* \leq b$. then \[
        \begin{aligned}
            ^*|x \pm^* y|^* \leq ^*|x|^* + ^*|y|^* \leq a+b\in \RR^{>0}\\
            ^*|x \cdot^* y|^* = ^*|x|^*\ ^*\cdot ^*|y|^* \leq a\cdot b\in \RR^{>0}
        \end{aligned}
        \]
        \item $x,y\in \mathcal{I}$ then $\forall a\in \RR^{>0}$ we have $|x|<\frac{a}{2}$
        Then $$|x\pm y| \leq \frac{a}{2} + \frac{a}{2} = a$$
        Let $z$ be finite then $|z|<b\in \RR^{>0}$
        Let $a\in \RR^{>0}$ then $|x|< \frac{a}{b}$ so 
        \[|xz| < \frac{a}{b}b = a \] 
    \end{enumerate}
}
\defin{infinitely close}{$x,y$ are called to be infinitely close ($x\simeq y$),\outernote{$\simeq$} if $y-x\in \mathcal{I}$}
\prop{}{
    \begin{enumerate}
        \item $\simeq$ is an equivalence relation
        \item $\simeq$ is congruent with $^*+,^*\cdot,^*-$
    \end{enumerate}
}{}
\lemma{}{Suppose $\lnot x\simeq y$ and at least one of $x,y$ is finite then there exists $q\in \RR$ 
such that $q$ is betweeen $x$ and $y$}{
    $y-x\notin \mathcal{I}$, wlog. $x<y$ then there exists $b\in \RR$ such that $0<b<y-x$ 
    and by the archimedian property there is $m\in \NN^{>0}$ such that $x<mb$.
    Let $m$ be the smallest such. i.e. $(m-1)b\leq x<mb$.
    And $mb<y$.
}
\prop{}{
    For every $x\in \mathcal{F}$ therre is exactly one $r\in \RR$ such that $x\sim r$
}{
    Let $S \defeq \{r\in \RR : r<x\}$. $S$ is bounded in $\RR$ because $|x|<r_0$ for 
    some $r_0\in \RR^{>0}$.
    Then $r\defeq \sup S$. Claim: $r\simeq x$. Lets assume by contradiction that this is not the case. 
    By the previous lemma, there is $q\in \RR$ such that 
    $r<q<x$ or $x<q<r$. but neither of this things can happen.
    \begin{itemize}
        \item $r<q<x$ is contradiction to $r$ not being an upper bound.
        \item $x<q<r$ is contradiction to $r$ is not the least upper bound.
    \end{itemize}
}
A concequence of that:
\coroll{for each $x\in \mathcal{F}$ there is a unique way of writing of $x$ in the form $r+i$ where $r\in \RR$ and $i\in \mathcal{I}$}
\note{}{If $x= r+i$ then we also write $\st(x) = r$.

}
\prop{}{
    \begin{itemize}
        \item $\st: \mathcal{F}\twoheadrightarrow \RR$ 
        \item $\st (x) = 0$ iff $x\in \mathcal{I}$
        \item $\st ( x\ ^* + y) = \st(x) + \st(y)$
        \item $\st ( x\ ^* \cdot y) = \st(x) \cdot \st(y)$
    \end{itemize}
}{}
\note{}{this says that $\st$ is a homomorphism of $\mathcal{F}$ onto field $\overline{\RR}$ with 
$\ker(\st) = \mathcal{I}$ and $\mathcal{F}/_\mathcal{I}\cong \overline{\RR}$

}
\defin{Convergence (non-standard definition)}{
    $F$ converges at $a$ to $b$ if whenever $x\simeq a$ and $x\neq a$ 
then $^*F(x)\simeq b$.}
\note{}{This definition is equivalent to $\varepsilon-\delta$ definition of convergence in Analysis.
\begin{itemize}
    \item Suppose $F$ converges to $b$ at $a$ in $\varepsilon-\delta$-sense
    \[\mathcal{R}\models \forall \varepsilon>0 \exists \delta>0 \forall z 
    ( |z-a|<\delta \implies |F(z)-b| < \varepsilon)\]
    \[\mathcal{R}^*\models \forall \varepsilon>0 \exists \delta>0 \forall z 
    ( |z-a|<\delta \implies |F(z)-b| < \varepsilon)\]
    Let $\varepsilon>0$ and $\delta>0$ corresponding to $\varepsilon$.
    Let $x\simeq a$ then $|x-a|<r$ for all positive $r\in \RR^{>0}$ so in particular $|x-a|<\delta$, 
    therefore $|F(x)-b|<\varepsilon$ but $\varepsilon$ was arbitrarily, so $st(F(x))=b$.
    \item Suppose $F$ convergences to $b$ at $a$ in the non-standard-sense.
    Then $\forall \varepsilon \in \RR^{>0}$ 
    $$\mathcal{R}^*\models \exists \delta >0 \forall x (|x-a|<\delta \to |F(x)-b|<\varepsilon)$$
    Because $\delta\in \mathcal{I}$ works.
    But then 
    $$\mathcal{R}\models \exists \delta >0 \forall x (|x-a|<\delta \to |F(x)-b|<\varepsilon)$$
\end{itemize}
}
\note{}{If $F$ converges to $b$ at $a$ then $b$ is unique such that for every $i\in \mathcal{I}$ 
the standard part $\st (F(a+i)) = b$. And we use the general notation $\lim_{x\to a}{F(x)}=b$}

\coroll{$F$ continuous at $a$ then $x\simeq a\implies \: ^*F(x)\simeq ^*F(a)$}
Derivatives
From Analysis: If $F:\RR \to \RR$ then $F'(a) = \lim_{h\to 0}\frac{F(a+h)-F(a)}{h}$ 
\defin{}{We will say that $F'(a) = b$ iff $\forall dx\in \mathcal{I}$, $dx\neq 0$ then 
\[\st\bigl(\frac{F(a+dx)-F(a)}{dx}\bigr) = b\]
}
$dF \defeq ^*F(a+dx) - F(a)$ then
$F'(a) = b$ iff $\forall dx\in \mathcal{I}, dx\neq 0$  we have $\st(\frac{dF}{dx}) = b$
$\frac{dF}{dx}$ is an actual division.

\bsp{}{
    $F(x) = x^2$
    \[\frac{dF}{dx} = \frac{(a+dx)^2 - a^2}{dx} = \frac{2dxa + (dx)^2}{dx} = 2a + dx\]
    and $\st\frac{dF}{dx} = 2a$
}
\prop{}{(standard) If $F'(a)$ exists, then $F$ is continuous at $a$.}{
    Assume $F'(a)$ (in the standard sense) exist, then $F'(a)$ is a finite number and 
    $F'(a) \simeq \frac{F(a+dx)-F(a)}{dx}$.
    Therefore $F(a+dx)-F(a)$ has to be infinitesimal ($\in \mathcal{I}$). 
    Which means $F(a+dx) \simeq F(a)$.
}
\prop{Chain rule}{Suppose $G'(a)$ and $F'(G(a))$ exist then $(F\circ G)'(a) = F'(G(a))\cdot G'(a)$
}{
    Note: $^*(F\circ G) = ^*F \circ ^* G$ because 
    $\mathcal{R} \models \forall x F_{f\circ g}(x) = (F_{f}\circ F_{g})(x)$
    \[dG \defeq ^*G(a+dx) - ^*G(a)\]
    \[\begin{aligned}
        dF \defeq& ^*(F\circ G)(a+dx) - ^*(F\circ G)(a)\\
        =& ^*F(^*G(a+dx)) - ^*F(^*G(a))\\
        =& ^*F(^*G(a) + dG)) - ^*F(^*G(a))\\
    \end{aligned}
    \]
    We know that $G^(a)$ exists so $G$ is continuous at $a$ and therefore $dG\simeq 0$
    \begin{itemize}
        \item case $dG\neq 0$ then $\frac{dF}{dG} \simeq F'(G(a))$.
        We can re-write $$\frac{dF}{dx} = \frac{dF}{dG}\frac{dG}{dx} = F'(G(a)) \cdot G'(a)$$
        \item case $dG = 0$ then $dF = 0$ and $G'(a) = \frac{dG}{dx} = 0$ and therefore ($dx\neq 0$)
        \[\frac{dF}{dx} =0 = F'(G(a))\frac{dG}{dx}\]
    \end{itemize}
}
\subsection{o-minimality}
\bsp{}{
    $\overline{\RR} = (\RR,+,-,\cdot, 0,1,\leq)$ $\overline{\RR} = (\RR,\leq)$ TODO or at least 
    in a very similar language, 
    then by quantifier elimination (QE, Tarski) all the definable sets of $\RR$ are finite unions 
    of points and intervals.
}
\defin{o-minimality}{Let $\mathcal{L} = \{\leq,\dots\}$, $\mathcal{M}$ is an $\mathcal{L}$-structure such that 
$\mathcal{M}\models \text{DLO}$ and the only definable subsets of $M$ are finite union of points and 
intervalls. Then $\mathcal{M}$ or equivalent $\Th(\mathcal{M})$ is called o-minimal.}
o-minimal is not a first order property so to say that a theory is o-minimal is non trivial.
\note{}{Cell decomposition means 
    Suppose $X$ is definable in an o-minimal structure $\mathcal{M}$, $X\subseteq M^n$ then 
    $X$ is a finite union of cells (in dimension 1 these are points or intervalls)
    in $M^2$ it is either the graph of a continuous function or everything inbetween two graphs of continuous 
    functions. (its an inductive definition)
}
\note{}{Have Dedekind complete for definable subets of $M$: 
For $X\subseteq M$ definable then $\inf X, \sup X$ exist in $M_{\pm \infty}$. }

\note{}{If $M$ contains infinitely small elements, for example $M = \!^*\RR$ then $(0,1)\subseteq M$ is not connected.
$O_1 = \{x: \forall n\in \NN^* 0<x<\frac{1}{n}\}$ is open and so is its complement in $(0,1)$. We have 

Note that $O_1$ is however not definable in $M$. If $O_1$ would be definable it would be a finite union 
of points and intervals. It is convex, and not a point. But it is also not an intervall, because then it 
would have by Dedekind completness that $\sup O_1$ exists in $M_{\pm \infty}$, a contradiction. TODO: 
}
\defin{definably connectedness}{$X\subseteq M^m$ is said to be definably connected, if $X$ is definable and $X$ is not the 
disjoint union of two definable, non-empty open sets.}
\lemma{}{
    \begin{enumerate}
        \item The definably connected subsets of $M$ are the intervalls (including singletons) and $\varnothing$.
        \item The image of a definable connected subset $X\subseteq M^n$ under a definable continuous map $f:X\to M^n$ is definably connected. ($f$ is called to be definable, if its graph $\Gamma f \subseteq M^{mn}$ is).
        \item (IVP) If $f:[a,b]\to M$ definable and continuous, then $f$ assumes all values between $f(a)$ and $f(b)$.
    \end{enumerate}
}{Exercise}
\subsection{o-minimal ordered groups and rings}
\defin{ordered group}{A ordered group is a group with a linear order such that 
\[\forall x \forall y \forall z x<y \to (zx<zy \land xz < yz)\]
}
\bsp{}{
    \begin{itemize}
        \item $(\RR,<,+)$ 
        \item $(\RR^{>0},<,\cdot)$
        \item non-example: $(\RR^*, \cdot,<)$
    \end{itemize}
}
Recall:
\begin{itemize}
    \item $(G,\cdot)$ is divisible, if $\forall n \forall g \exists x g = x^n$, equivalent to $\forall n G^n = G$.
    \item $(G,\cdot)$ is torsion-free, if no element has finite order except for $1$.
\end{itemize}
\prop{}{$(M,<,\cdot, \dots)$ o-minimal such that $(M,<,\cdot)$ ordered group, then
    $(M,<,\cdot)$ abelian, divisible and torsion-free.
}{}
\lemma{}{If $G$ is a definable subgroup of $M$ then $G$ is convex.
}{
    Suppose $G$ is not convex, then there exists $1<a<g$ for some $g\in G$ and $a\in M\backslash G$. 
    Then 
    \[1<a<g<ag<g^2<ag^2<g^3<\dots \]
    but elements alternate being in $G$ and outside of $G$ so $G$ is not definable (finite union).
}
\lemma{}{The only definable subsets of $M$ that are subgroups are $\{1\}$ and $M$.
}{
    Suppose $G\neq \{1\}$ wts. $G = M$.
    From the previous lemma we know that $G$ is convex.
    The idea is $s\defeq \sup G$ then $1<s$ and $(1,s)\subseteq G$. If $s=+\infty$ then $G = M$.
    Suppose $s\neq +\infty$ then 
    Take $1<g<s$ then $g^{-1}s\in (1,s)$
    So $s = g g^{-1}s\in G$ 
    and $s<sg$ thats a contradiction with $s = \sup G$. 
}
\begin{proof}
    of Proposition.
    \begin{itemize}
        \item $(M,\cdot)$ abelian:
        For any $a\in M$ we can look at $C_a = \{x\in M : xa = ax\}$ it is a definable subgroup and contains $a$ it therefore is non-trivial and we have $C_a = M$ for every $a\in M$, so abelian.
        \item For any $n\in \NN^{>0}$ look at $\{x^n: x\in M\}$ non trivial definable subgroup of $M$, hence $=M$.
        \item Every ordered group is torsion-free.
    \end{itemize}
\end{proof}
\defin{Ordered ring}{A ring (assumed to always be associative, with $1$)
 equipped with a linear order such that
\begin{enumerate}
    \item $0<1$
    \item $<$ translation invariant
    \item $<$ invariant under multiplication by positive elements
\end{enumerate}
}

\note{}{
    \begin{itemize}
        \item The additive group $(R,<,+)$ of an ordered ring is a ordered group. 
        \item Ordered rings have no zero-divisors $\forall x \forall y xy = 0 \to (x=0 \lor y = 0)$
        \item $x^2\geq 0$ 
        \item $k\mapsto k \cdot 1 : \ZZ \to \text{ring}$ is a strictly increasing embedding with resprect to the usual ordering on $\ZZ$ that means our characteristic is $0$.
    \end{itemize}
}
\note{}{
    \begin{itemize}
        \item A division ring is a field without commutativity of multiplication, so 
        \[\forall x x\neq 0 \to \exists y xy = 1\]
        \item Suppose ordered ring is also a division ring. Then such $y$ are unique and $yx=1$. Further, $x>0 \to y>0$.
        
        Also the additive group is divisible, the underlying set is DLO w/o endpoints and 
        $(x,y)\to x \cdot y$
        $x\to x^{-1}$ are continuous with resprect to itervall topology.
    \end{itemize}
}
\defin{ordered field}{An ordered ring is an ordered division ring with commutative multiplication.}
\defin{real closed field}{ordered field $R$ \outernote{RCF} such that if $f(X)\in R[X]$ and $a<b$ are such that 
$f(a)<0<f(b)$ then there exists a $c\in (a,b)$ such that $f(c)=0$}
\bsp{}{
    \begin{itemize}
        \item $(\RR,+,\cdot,<)$ is RCF
        \item $(\mathbb{Q},+,\cdot,<)$ is not a RCF
    \end{itemize}
}
\prop{}{$(M,<,+,\cdot,\dots)$ o-minimal such that $(M,<,+,\cdot)$ is ordered ring then $(M,<,+,\cdot)$ is RCF.}{
    \begin{itemize}
        \item wts. $(M;<,+,\cdot)$ is ordered division ring.
            For all $a\in M$ $aM$ is additive subgroup of $(M,+)$ hence $aM = M$ if $a\neq 0$.

        \item wts. commutativity of $\cdot$. $\text{Pos}(M) \defeq \{a\in M: a>0\}$ is a subgroup of the multiplicative group of $M$. Let $a\in M$ then bc $M = aM$ we have $b\in M$ such that $1=a \cdot b$ and by note $0<a$ then $0<a^{-1}$.
        so multiplication is commutative on $M$
        \item IVP property for polynomials:
        The ring operations are continuous, see note and use lemma about IVP (c).
    \end{itemize}
}
\subsubsection{Cell decomposition}
Base step: 
\prop{Monotonicity Theorem}{
    Suppose $f:(a,b)\to M$ definable, then there are $a<c_1< \dots < c_k<b$ such that for $(a,c_1)$, $(c_i,c_{i+1})$, $(c_k,b)$ partition of $(a,b)$ we have: $f$ is either constant or strictly monotinic and continuous.
}{}
\lemma{}{$\exists$ subinterval on which $f$ is const or incective}{}
\lemma{}{If $f$ injective, then strictly monotone on a subinterval}{}
\lemma{}{If $f$ strictly monotone, then $f$ continuous on a subinterval}{}

\begin{proof}
    Proof of Monotonicity theorem:
    Consider $$X \defeq \biggl\{x\in (a,b) : \stackrel{\text{on some subinterval containing $x$,}}
    {\text{$f$ is either constant or strictly monotone and continuous}} \biggr\}$$
    remark: $X$ is a definable set.
    Look at $(a,b)-X$ is finite. If not, it would contain subinterval use lemma to get contradiction.
    WMA:\addAbbrev{WMA}{We may assume} $X = (a,b)$ in particular we may assume $f$ continuous.
    By subdividin $(a,b)$ further WMA that we are in one of the following cases
    \begin{enumerate}
        \item[Case 1:] $\forall x \in (a,b)$ $f$ constant on some neighborhood of $x$
        \item[Case 2:] $\forall x \in (a,b)$ $f$ is strictly monotone increasing on some neighborhood of $x$
        \item[Case 3:] $\forall x \in (a,b)$ $f$ is strictly monotone decreasing on some neighborhood of $x$
    \end{enumerate}
    \begin{enumerate}
        \item[Case 1:] $x_0 \in (a,b)$ then 
        $s \defeq \{ x: x_0<x<b \land f \text{ cont. on $[x_0,x)$}\}$
        wts $s=b$ suppose $s<b$ then $f$ constant on neighborhood of $s$ contradiction with definition of $s$ so $f$ continuous on $[x_0,b)$. $f$ constant on $(a,x_0]$ similar.
        \item[Case 2:] $x_0\in (a,b)$ then $s\defeq \{x: x_0<x<b \land f \text{strictly incr. on } [x_0,x) \}$. wts: $s=b$ assume $s<b$ then $f$ is strictly increasing on some neighborhood of $s$ so $f$ strictly increasing on $[x_0,s+\delta)$ for some $\delta>0$, a contradiction to definition of $s$. 
        \item[Case 3:] similar to Case 2. 
    \end{enumerate}
\end{proof}